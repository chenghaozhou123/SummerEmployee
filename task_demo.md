task1中是正常更新入库

task2中判断当天是否是交易日，是的话就入库，否则跳过

**可以直接不加条件，一起正常入库，因为加了一个判断条件，数据为空时就不入库了**

task3一是对部分当天的数据正常更新入库，二是判断当天是否为交易日，如果是的话则入库部分数据上一个交易日的数据

task4正常入库

task5判断是否为交易日，是的话更新入库

task6正常更新入库

task7正常更新入库数据，然后如果当天是交易日，需要追加3个数据来更新入库

**总而言之，我直接拿所有当天的数据就行了，没有的话我就是空，就给跳过掉不更新**

如果发现什么bug再改



**daily_save has a symbol that each col save in different file.There has any difference saving in ck? maybe not**



**difference between daily_save and update**

```
AShareEODDerivativeIndicator'
```

```
'AShareEODDerivativeIndicator',  conflict with tables in test 
```

AShareEODPrices



**factor11**

是从eqa测试拿的数据bar_day

**uqer wind zyyx**

这三个个数据从一下几个地方拿到：

```python
if database == 'wind':
    self.database=database
    self.engine = create_engine('oracle://dcuser:Eam123456@192.168.1.213:1521/orcl')
    
elif database == 'zyyx':
    self.database='DCUSER'
    dsn_tns = cx_Oracle.makedsn('192.168.1.65', 1521, 'orcl')
    self.engine = cx_Oracle.connect(
        'dcuser', 'Eam123456', dsn_tns, encoding='UTF-8')
    
    
elif database == 'uqer':
    self.database='wind'
    self.engine = create_engine('oracle://dcuser:Eam123456@192.168.1.213:1521/orcl')
    uqer.Client(token='ab590982e5ffa7ab9c20caf058d92a42c299cfcf189c1e2a6077b979981905dd')
```

**报错**：有一个报错是报dont has attribute startwith 原因是字段中重复了party_id 去重后成功，去重代码为：

```python
self.table = self.table.iloc[:, np.unique(self.table.columns, return_index=True)[1]]
```

**上传uqer的时候出现报错：**

在CashFlowTtmPit后的数据：出现date与datetime无法比较，修改后成功

citicindustry 、'ShenwanIndustry'    upload时报错：Unable to cast Python instance to C++ type (compile in debug mode for details)

'NoneType' object has no attribute 'startswith' 报错。

MainDataPit  与原数据类型不匹配，在数据集市中已经存在不匹配的表



['logtime', 'id', 'author', 'module', 'code', 'status', 'date', 'message', 'batch_id']





weigth 名字后面加描述 字段加在后面



几个数据存在问题：

```
uqer:
ERROR:root:CiticIndustry on 2022-08-11 daily_save error: Unable to cast Python instance to C++ type (compile in debug mode for details)
ERROR:root:ShenwanIndustry on 2022-08-11 daily_save error: Unable to cast Python instance to C++ type (compile in debug mode for details)

zyyx:
ERROR:root:Con_Forecast_Stk on 2022-08-12 00:00:00 daily_save error: 字段con_eps_hisdate 数据格式为<class 'pandas._libs.tslibs.nattype.NaTType'>，protobuf序列化无法解析,expect: int, float, bool, str,datetime

ERROR:root:Fin_Performance_Forecast on 2022-08-12 00:00:00 daily_save error: 字段chg_reason 数据格式为<class 'cx_Oracle.LOB'>，protobuf序列化无法解析,expect: int, float, bool, str,datetime

ERROR:root:Fin_Performance_Express on 2022-08-12 00:00:00 daily_save error: 字段chg_reason 数据格式为<class 'cx_Oracle.LOB'>，protobuf序列化无法解析,expect: int, float, bool, str,datetime
```



源码解读：

```python
在调用数据库方法的时候使用grpc调用：
grpc.insecure_channel() 创建客户端连接到服务端，第一个参数是地址
channel = grpc.insecure_channel("{}:{}".format(self.datahub, DATAHUB_PORT),options=[
       ('grpc.max_send_message_length', MAX_MESSAGE_LENGTH),
       ('grpc.max_receive_message_length', MAX_MESSAGE_LENGTH)])
```

```python
Creates a UnaryUnaryMultiCallable for a unary-unary method.
channel.unary_unary()
第一个参数是rpc的方法名。
第二个参数为对请求信息做序列化。
第三个参数为反序列化。
该方法会返回一个初始化好的类：_UnaryUnaryMultiCallable
self.DeleteDataset = channel.unary_unary(
      '/api.datahub.dataset.v1.Dataset/DeleteDataset',
  request_serializer=datahub__pysdk_dot_py__sdk__pb2.DeleteDatasetRequest.SerializeToString,
    response_deserializer=datahub__pysdk_dot_py__sdk__pb2.DeleteDatasetReply.FromString,
        )
```

```python
调用该方法：
response  = ClearDataset(py_sdk_pb2.ClearDatasetRequest(db_table={"table_name":table_name,"db_name":db_name}), metadata=[('authorization', 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJqaGxfcXVhbnR3ZWIiLCJleHAiOjE2NjE3NTE5MjUsInN1YiI6IjE1NDY2NjM4OTc3MzIyMjI5NzYifQ.1WNEJxqfM0IGT_A3hR8z-715QST8W6-Zp1GnDR73JcE')])
grpc python源码的__call__函数如下：
__call__(self,
                 request,
                 timeout=None,
                 metadata=None,
                 credentials=None,
                 wait_for_ready=None,
                 compression=None):
对应上面的函数就是，request = py_sdk_pb2.ClearDatasetRequest(db_table{"table_name":table_name,"db_name":db_name})
对py_sdk_pb2.ClearDatasetRequest(db_table{"table_name":table_name,"db_name":db_name}进行解析：
                                
ClearDatasetRequest = _reflection.GeneratedProtocolMessageType('ClearDatasetRequest', (_message.Message,), {
  'DESCRIPTOR' : _CLEARDATASETREQUEST,
  '__module__' : 'datahub_pysdk.py_sdk_pb2'
  # @@protoc_insertion_point(class_scope:api.datahub.dataset.v1.ClearDatasetRequest)
  })
_sym_db.RegisterMessage(ClearDatasetRequest)
 
```

stub = decodereq_pb2_grpc.DecodeStub(channel)        

resp = stub.DecodeReq(decodereq_pb2.PortraitDecodeReq(**data), timeout=2.0) 

保存：replace = True只能在有表的时候才能用，否则会报一个找不到表，建议这些能不能加上先查找是否存在表

其他的表只要ods
ods的话就是ods+表明

```python
[2022-08-25 16:53:32,784] [ERROR] AIndexCSI500Weight on 2022-08-22 12:00:00 daily_save error: data(上传数据)中存在空值，请注意检查！
[2022-08-25 16:53:36,892] [ERROR] AIndexHS300Weight on 2022-08-22 12:00:00 daily_save error: data(上传数据)必须为三列数据！
[2022-08-25 16:53:37,288] [ERROR] AIndexSSE50Weight on 2022-08-22 12:00:00 daily_save error: data(上传数据)中存在空值，请注意检查！
```





8.26 任务 

odsindex——500不是去重表 已完成

8.29

AShareANNFinancialIndicator

{('s_fa_yoyeps_basic', 'Float64'), ('net_profit_yoy', 'Float64'), ('s_fa_yoyop', 'Float64'), ('yoy_roe_diluted', 'Float64'), ('yoy_net_cash_flows', 'Float64'), ('s_fa_yoyequity', 'Float64'), ('net_profit', 'Float64'), ('s_fa_yoyeps_diluted', 'Float64'), ('s_fa_yoyocfps', 'Float64')}与原数据表类型不匹配{'ann_dt': 'String', 'contributionps': 'String', 'crncy_code': 'String', 'growth_bps_sh': 'Float64', 'iflisted_data': 'Float64', 'memo': 'String', 'net_profit': 'String', 'net_profit_yoy': 'String', 'opdate': 'String', 'opmode': 'String', 'rd_expense': 'Float64', 'report_period': 'String', 'roe_diluted': 'Float64', 'roe_ex': 'Float64', 'roe_exweighted': 'Float64', 'roe_weighted': 'Float64', 's_fa_arturn': 'Float64', 's_fa_bps': 'Float64', 's_fa_bps_adjust': 'String', 's_fa_bps_sh': 'Float64', 's_fa_current': 'Float64', 's_fa_deductedprofit': 'Float64', 's_fa_deductedprofit_yoy': 'Float64', 's_fa_eps_basic': 'Float64', 's_fa_eps_diluted': 'Float64', 's_fa_eps_diluted2': 'Float64', 's_fa_eps_ex': 'Float64', 's_fa_eps_exbasic': 'Float64', 's_fa_eps_exdiluted': 'Float64', 's_fa_extraordinary': 'Float64', 's_fa_invturn': 'Float64', 's_fa_ocfps': 'Float64', 's_fa_quick': 'Float64', 's_fa_yoyebt': 'String', 's_fa_yoyeps_basic': 'String', 's_fa_yoyeps_diluted': 'String', 's_fa_yoyequity': 'String', 's_fa_yoyocfps': 'String', 's_fa_yoyop': 'String', 's_ft_debttoassets': 'Float64', 's_info_compcode': 'String', 's_info_div': 'String', 's_info_windcode': 'String', 'statement_type': 'Int64', 'yoy_net_cash_flows': 'String', 'yoy_roe_diluted': 'String'}



Asharecashflow

[2022-08-26 18:48:25,549] [ERROR] AShareCashFlow on 2022-08-25 12:00:00 daily_save error: 字段或者类型：{('unconfirmed_invest_loss', 'String'), ('fa_fnc_leases', 'String'), ('comm_insur_plcy_paid', 'Float64'), ('incr_acc_exp', 'String'), ('spe_bal_cash_outflows_inv', 'Float64'), ('spe_bal_cash_inflows_inv', 'Float64'), ('net_incr_disp_tfa', 'Float64'), ('cash_pay_claims_orig_inco', 'Float64'), ('net_incr_dep_cbob', 'Float64'), ('net_incr_pledge_loan', 'Float64'), ('s_dismantle_capital_add_net', 'Float64'), ('conv_corp_bonds_due_within_1y', 'String')}与原数据表类型不匹配{'actual_ann_dt': 'String', 'amort_intang_assets': 'Float64', 'amort_lt_deferred_exp': 'Float64', 'ann_dt': 'String', 'cash_cash_equ_beg_period': 'Float64', 'cash_cash_equ_end_period': 'Float64', 'cash_paid_invest': 'Float64', 'cash_pay_acq_const_fiolta': 'Float64', 'cash_pay_beh_empl': 'Float64', 'cash_pay_claims_orig_inco': 'String', 'cash_pay_dist_dpcp_int_exp': 'Float64', 'cash_pay_goods_purch_serv_rec': 'Float64', 'cash_prepay_amt_borr': 'Float64', 'cash_recp_borrow': 'Float64', 'cash_recp_cap_contrib': 'Float64', 'cash_recp_disp_withdrwl_invest': 'Float64', 'cash_recp_prem_orig_inco': 'Float64', 'cash_recp_return_invest': 'Float64', 'cash_recp_sg_and_rs': 'Float64', 'comm_insur_plcy_paid': 'String', 'comp_type_code': 'String', 'conv_corp_bonds_due_within_1y': 'Float64', 'conv_debt_into_cap': 'Float64', 'crncy_code': 'String', 'decr_deferred_exp': 'Float64', 'decr_deferred_inc_tax_assets': 'Float64', 'decr_inventories': 'Float64', 'decr_oper_payable': 'Float64', 'depr_fa_coga_dpba': 'Float64', 'eff_fx_flu_cash': 'Float64', 'end_bal_cash': 'Float64', 'fa_fnc_leases': 'Float64', 'fin_exp': 'Float64', 'free_cash_flow': 'Float64', 'handling_chrg_paid': 'Float64', 'im_net_cash_flows_oper_act': 'Float64', 'im_net_incr_cash_cash_equ': 'Float64', 'incl_cash_rec_saims': 'Float64', 'incl_dvd_profit_paid_sc_ms': 'Float64', 'incr_acc_exp': 'Float64', 'incr_deferred_inc_tax_liab': 'Float64', 'incr_oper_payable': 'Float64', 'invest_loss': 'Float64', 'is_calculation': 'Int64', 'less_beg_bal_cash': 'Float64', 'less_beg_bal_cash_equ': 'Float64', 'loss_disp_fiolta': 'Float64', 'loss_fv_chg': 'Float64', 'loss_scr_fa': 'Float64', 'net_cash_flows_fnc_act': 'Float64', 'net_cash_flows_inv_act': 'Float64', 'net_cash_flows_oper_act': 'Float64', 'net_cash_pay_aquis_sobu': 'Float64', 'net_cash_received_reinsu_bus': 'Float64', 'net_cash_recp_disp_fiolta': 'Float64', 'net_cash_recp_disp_sobu': 'Float64', 'net_incr_cash_cash_equ': 'Float64', 'net_incr_clients_loan_adv': 'Float64', 'net_incr_dep_cbob': 'String', 'net_incr_dep_cob': 'Float64', 'net_incr_disp_faas': 'String', 'net_incr_disp_tfa': 'String', 'net_incr_fund_borr_ofi': 'Float64', 'net_incr_insured_dep': 'Float64', 'net_incr_int_handling_chrg': 'Float64', 'net_incr_loans_central_bank': 'Float64', 'net_incr_loans_other_bank': 'Float64', 'net_incr_pledge_loan': 'String', 'net_incr_repurch_bus_fund': 'Float64', 'net_profit': 'Float64', 'opdate': 'String', 'opmode': 'String', 'other_cash_pay_ral_fnc_act': 'Float64', 'other_cash_pay_ral_inv_act': 'Float64', 'other_cash_pay_ral_oper_act': 'Float64', 'other_cash_recp_ral_fnc_act': 'Float64', 'other_cash_recp_ral_inv_act': 'Float64', 'other_cash_recp_ral_oper_act': 'Float64', 'others': 'String', 'pay_all_typ_tax': 'Float64', 'plus_end_bal_cash_equ': 'Float64', 'plus_prov_depr_assets': 'Float64', 'proc_issue_bonds': 'Float64', 'recp_tax_rends': 'Float64', 'report_period': 'String', 's_dismantle_capital_add_net': 'String', 's_info_compcode': 'String', 's_info_windcode': 'String', 'securitie_netcash_received': 'Float64', 'spe_bal_cash_inflows_fnc': 'Float64', 'spe_bal_cash_inflows_inv': 'String', 'spe_bal_cash_inflows_oper': 'Float64', 'spe_bal_cash_outflows_fnc': 'Float64', 'spe_bal_cash_outflows_inv': 'String', 'spe_bal_cash_outflows_oper': 'Float64', 'spe_bal_netcash_equ_undir': 'Float64', 'spe_bal_netcash_inc': 'String', 'spe_bal_netcash_inc_undir': 'String', 'statement_type': 'String', 'stot_cash_inflows_fnc_act': 'Float64', 'stot_cash_inflows_inv_act': 'Float64', 'stot_cash_inflows_oper_act': 'Float64', 'stot_cash_outflows_fnc_act': 'Float64', 'stot_cash_outflows_inv_act': 'Float64', 'stot_cash_outflows_oper_act': 'Float64', 'tot_bal_cash_inflows_fnc': 'Float64', 'tot_bal_cash_inflows_inv': 'Float64', 'tot_bal_cash_inflows_oper': 'Float64', 'tot_bal_cash_outflows_fnc': 'Float64', 'tot_bal_cash_outflows_inv': 'Float64', 'tot_bal_cash_outflows_oper': 'Float64', 'tot_bal_netcash_equ_undir': 'Float64', 'tot_bal_netcash_inc': 'Float64', 'tot_bal_netcash_inc_undir': 'Float64', 'tot_bal_netcash_outflows_fnc': 'Float64', 'tot_bal_netcash_outflows_inv': 'Float64', 'tot_bal_netcash_outflows_oper': 'Float64', 'unconfirmed_invest_loss': 'Float64', 'wind_code': 'String'}



Ashareincome:

[2022-08-26 18:48:29,901] [ERROR] AShareIncome on 2022-08-25 12:00:00 daily_save error: 字段或者类型：{('net_inc_sec_uw_bus', 'Float64'), ('chg_unearned_prem_res', 'Float64'), ('other_bus_inc', 'Float64'), ('net_int_inc', 'Float64'), ('net_inc_ec_asset_mgmt_bus', 'Float64'), ('less_ceded_out_prem', 'Float64'), ('oper_exp', 'Float64'), ('prem_inc', 'Float64'), ('reinsurance_exp', 'Float64'), ('dvd_exp_insured', 'Float64'), ('other_bus_cost', 'Float64'), ('less_handling_chrg_comm_exp', 'Float64'), ('prepay_surr', 'Float64'), ('insur_prem_unearned', 'Float64'), ('il_net_loss_disp_noncur_asset', 'String'), ('less_int_exp', 'Float64'), ('tot_claim_exp', 'Float64'), ('less_exp_recb_reinsurer', 'Float64'), ('net_handling_chrg_comm_inc', 'Float64'), ('plus_net_inc_other_bus', 'Float64'), ('chg_insur_cont_rsrv', 'Float64'), ('less_claim_recb_reinsurer', 'Float64'), ('net_profit_under_intl_acc_sta', 'Float64'), ('net_inc_sec_trading_brok_bus', 'Float64'), ('less_ins_rsrv_recb_reinsurer', 'Float64'), ('net_inc_other_ops', 'Float64')}与原数据表类型不匹配{'actual_ann_dt': 'String', 'adjlossgain_prevyear': 'String', 'ann_dt': 'String', 'asset_disposal_income': 'Float64', 'capitalized_comstock_div': 'String', 'chg_insur_cont_rsrv': 'String', 'chg_unearned_prem_res': 'String', 'comp_type_code': 'String', 'comshare_dvd_payable': 'String', 'continued_net_profit': 'Float64', 'credit_impairment_loss': 'Float64', 'crncy_code': 'String', 'distributable_profit': 'String', 'distributable_profit_shrhder': 'String', 'dvd_exp_insured': 'String', 'ebit': 'Float64', 'ebitda': 'Float64', 'end_net_profit': 'Float64', 'fin_exp_int_inc': 'Float64', 'handling_chrg_comm_inc': 'Float64', 'il_net_loss_disp_noncur_asset': 'Float64', 'inc_tax': 'Float64', 'incl_inc_invest_assoc_jv_entp': 'Float64', 'incl_reinsurance_prem_inc': 'String', 'insur_prem_unearned': 'String', 'insurance_expense': 'String', 'int_inc': 'Float64', 'is_calculation': 'Int64', 'less_ceded_out_prem': 'String', 'less_claim_recb_reinsurer': 'String', 'less_exp_recb_reinsurer': 'String', 'less_fin_exp': 'Float64', 'less_gerl_admin_exp': 'Float64', 'less_handling_chrg_comm_exp': 'String', 'less_impair_loss_assets': 'Float64', 'less_ins_rsrv_recb_reinsurer': 'String', 'less_int_exp': 'String', 'less_non_oper_exp': 'Float64', 'less_oper_cost': 'Float64', 'less_selling_dist_exp': 'Float64', 'less_taxes_surcharges_ops': 'Float64', 'memo': 'String', 'minority_int_inc': 'Float64', 'net_after_ded_nr_lp_correct': 'String', 'net_exposure_hedging_benefits': 'Float64', 'net_handling_chrg_comm_inc': 'String', 'net_inc_ec_asset_mgmt_bus': 'String', 'net_inc_other_ops': 'String', 'net_inc_sec_trading_brok_bus': 'String', 'net_inc_sec_uw_bus': 'String', 'net_int_inc': 'String', 'net_profit_after_ded_nr_lp': 'Float64', 'net_profit_excl_min_int_inc': 'Float64', 'net_profit_incl_min_int_inc': 'Float64', 'net_profit_under_intl_acc_sta': 'String', 'opdate': 'String', 'oper_exp': 'String', 'oper_profit': 'Float64', 'oper_rev': 'Float64', 'opmode': 'String', 'other_bus_cost': 'String', 'other_bus_inc': 'String', 'other_compreh_inc': 'Float64', 'other_income': 'Float64', 'plus_net_gain_chg_fv': 'Float64', 'plus_net_gain_fx_trans': 'Float64', 'plus_net_inc_other_bus': 'String', 'plus_net_invest_inc': 'Float64', 'plus_non_oper_rev': 'Float64', 'prem_inc': 'String', 'prepay_surr': 'String', 'prfshare_dvd_payable': 'String', 'rd_expense': 'Float64', 'reinsurance_exp': 'String', 'report_period': 'String', 's_fa_eps_basic': 'Float64', 's_fa_eps_diluted': 'Float64', 's_info_compcode': 'String', 's_info_windcode': 'String', 'spe_bal_net_profit': 'String', 'spe_bal_oper_profit': 'String', 'spe_bal_tot_profit': 'String', 'statement_type': 'String', 'stmnote_finexp': 'Float64', 'tot_bal_net_profit': 'Float64', 'tot_bal_oper_profit': 'Float64', 'tot_bal_tot_profit': 'Float64', 'tot_claim_exp': 'String', 'tot_compreh_inc': 'Float64', 'tot_compreh_inc_min_shrhldr': 'Float64', 'tot_compreh_inc_parent_comp': 'Float64', 'tot_oper_cost': 'Float64', 'tot_oper_rev': 'Float64', 'tot_profit': 'Float64', 'transfer_from_housingimprest': 'String', 'transfer_from_others': 'String', 'transfer_from_surplusreserve': 'String', 'unconfirmed_invest_loss': 'String', 'undistributed_profit': 'String', 'wind_code': 'String', 'withdr_buzexpwelfare': 'String', 'withdr_legalpubwelfunds': 'String', 'withdr_legalsurplus': 'String', 'withdr_othersurpreserve': 'String', 'withdr_reservefund': 'String', 'workers_welfare': 'String'}



ashareauditoponion:

[2022-08-26 18:48:32,443] [ERROR] AShareAuditOpinion on 2022-08-25 12:00:00 daily_save error: 字段或者类型：{('s_pay_audit_expenses', 'Float64'), ('s_in_control_audit_opinion', 'Float64')}与原数据表类型不匹配{'ann_dt': 'String', 'ann_dt1': 'String', 'opdate': 'String', 'opmode': 'String', 'report_period': 'String', 's_audit_fee_memo': 'String', 's_audit_result_memo': 'String', 's_in_control_accountant': 'String', 's_in_control_accounting_firm': 'String', 's_in_control_audit': 'String', 's_in_control_audit_opinion': 'String', 's_info_windcode': 'String', 's_pay_audit_expenses': 'String', 's_stmnote_audit_agency': 'String', 's_stmnote_audit_category': 'Int64', 's_stmnote_audit_cpa': 'String'}





ashareTTMandMRQ:

[2022-08-26 18:48:34,780] [ERROR] AShareTTMAndMRQ on 2022-08-25 12:00:00 daily_save error: 字段或者类型：{('s_fa_expense_ttm', 'Float64')}与原数据表类型不匹配{'fa_roic_ttm': 'Float64', 'opdate': 'String', 'opmode': 'String', 'report_period': 'String', 'roa_exclminintinc_ttm': 'Float64', 's_fa_adminexpense_ttm': 'Float64', 's_fa_adminexpensetogr_ttm': 'Float64', 's_fa_asset_mrq': 'Float64', 's_fa_bps_new': 'Float64', 's_fa_cashflow_ttm': 'Float64', 's_fa_cfps_ttm': 'Float64', 's_fa_cost_ttm': 'Float64', 's_fa_debt_mrq': 'Float64', 's_fa_debttoassets_mrq': 'Float64', 's_fa_ebit_ttm': 'Float64', 's_fa_ebt_ttm': 'Float64', 's_fa_ebttoor_ttm': 'Float64', 's_fa_eps_ttm': 'Float64', 's_fa_equity_mrq': 'Float64', 's_fa_equity_new': 'Float64', 's_fa_expense': 'Float64', 's_fa_expense_ttm': 'String', 's_fa_expensetosales_ttm': 'Float64', 's_fa_finaexpense_ttm': 'Float64', 's_fa_finaexpensetogr_ttm': 'Float64', 's_fa_financecashflow_ttm': 'Float64', 's_fa_gc_ttm': 'Float64', 's_fa_gctogr_ttm': 'Float64', 's_fa_gr_ttm': 'Float64', 's_fa_grossmargin_ttm': 'Float64', 's_fa_grossprofitmargin_ttm': 'Float64', 's_fa_impairment_ttm': 'Float64', 's_fa_impairtogr_ttm': 'Float64', 's_fa_investcapital_mrq': 'Float64', 's_fa_investcashflow_ttm': 'Float64', 's_fa_investincome_ttm': 'Float64', 's_fa_investincometoebt_ttm': 'Float64', 's_fa_netprofit_ttm': 'Float64', 's_fa_netprofitmargin_ttm': 'Float64', 's_fa_netprofittoor_ttm': 'Float64', 's_fa_nonoperateprofit_ttm': 'Float64', 's_fa_nonoperateprofittoebt_ttm': 'Float64', 's_fa_nonopprofit_ttm': 'Float64', 's_fa_noptoebt_ttm': 'Float64', 's_fa_ocfps_ttm': 'Float64', 's_fa_ocftoop_ttm': 'Float64', 's_fa_ocftooperateincome_ttm': 'Float64', 's_fa_ocftoor_ttm': 'Float64', 's_fa_op_ttm': 'Float64', 's_fa_operatecashflow_ttm': 'Float64', 's_fa_operateexpense_ttm': 'Float64', 's_fa_operateexpensetogr_ttm': 'Float64', 's_fa_operateincome_ttm': 'Float64', 's_fa_operateincometoebt_ttm': 'Float64', 's_fa_optoebt_ttm': 'Float64', 's_fa_optogr_ttm': 'Float64', 's_fa_optoor_ttm': 'Float64', 's_fa_or_ttm': 'Float64', 's_fa_orps_ttm': 'Float64', 's_fa_prefinexp_op_ttm': 'Float64', 's_fa_prefinexpoptoebt_ttm': 'Float64', 's_fa_prefinexpoptoor_ttm': 'Float64', 's_fa_profit_ttm': 'Float64', 's_fa_profittogr_ttm': 'Float64', 's_fa_roa2_ttm': 'Float64', 's_fa_roa_ttm': 'Float64', 's_fa_roe_ttm': 'Float64', 's_fa_salescashin_ttm': 'Float64', 's_fa_salescashintoor_ttm': 'Float64', 's_fa_taxtoebt_ttm': 'Float64', 's_fa_totalequity_mrq': 'Float64', 's_info_windcode': 'String', 's_stm_bsmrq': 'Float64', 'statement_type': 'String'}



balancesheet:

[2022-08-26 18:48:44,705] [ERROR] BalanceSheet on 2022-08-24 00:00:00 daily_save error: 字段或者类型：{('loan_to_oth_bank_fi', 'Float64'), ('preferred_stock_e', 'Float64'), ('pur_resale_fa', 'Float64'), ('perpetual_bond_e', 'Float64'), ('cb_borr', 'Float64'), ('specific_payables', 'Float64'), ('loan_fr_oth_bank_fi', 'Float64'), ('commis_payable', 'Float64'), ('depos', 'Float64'), ('preferred_stock_l', 'Float64'), ('insur_reser', 'Float64'), ('reinsur_payable', 'Float64'), ('funds_sec_trad_agen', 'Float64'), ('sold_for_repur_fa', 'Float64'), ('funds_sec_undw_agen', 'Float64'), ('reinsur_receiv', 'Float64'), ('produc_biol_assets', 'Float64'), ('premium_receiv', 'Float64'), ('reinsur_reser_receiv', 'Float64'), ('sett_prov', 'Float64'), ('ordin_risk_reser', 'Float64'), ('oil_and_gas_assets', 'Float64'), ('disbur_la', 'Float64'), ('perpetual_bond_l', 'Float64')}与原数据表类型不匹配{'accouting_standards': 'String', 'accrued_exp': 'String', 'act_pubtime': 'DateTime64', 'advance_receipts': 'Float64', 'ap': 'Float64', 'ar': 'Float64', 'asset_class': 'String', 'avail_for_sale_fa': 'String', 'bond_payable': 'Float64', 'capital_reser': 'Float64', 'cash_c_equiv': 'Float64', 'cb_borr': 'String', 'cip': 'Float64', 'cn_spell': 'String', 'commis_payable': 'String', 'const_materials': 'Float64', 'currency_cd': 'String', 'defer_revenue': 'Float64', 'defer_tax_assets': 'Float64', 'defer_tax_liab': 'Float64', 'delist_date': 'String', 'depos': 'String', 'disbur_la': 'String', 'div_payable': 'Float64', 'div_receiv': 'Float64', 'dy_use_flg': 'Int64', 'end_date': 'DateTime64', 'end_date_rep': 'DateTime64', 'estimated_liab': 'Float64', 'ex_country_cd': 'String', 'exchange_cd': 'String', 'fiscal_period': 'Int64', 'fixed_assets': 'Float64', 'fixed_assets_disp': 'Float64', 'forex_differ': 'String', 'funds_sec_trad_agen': 'String', 'funds_sec_undw_agen': 'String', 'goodwill': 'Float64', 'htm_invest': 'String', 'id': 'Int64', 'insur_reser': 'String', 'int_payable': 'Float64', 'int_receiv': 'Float64', 'intan_assets': 'Float64', 'inventories': 'Float64', 'invest_real_estate': 'Float64', 'list_date': 'DateTime64', 'list_status_cd': 'String', 'loan_fr_oth_bank_fi': 'String', 'loan_to_oth_bank_fi': 'String', 'lt_amor_exp': 'Float64', 'lt_borr': 'Float64', 'lt_equity_invest': 'Float64', 'lt_payable': 'Float64', 'lt_receiv': 'Float64', 'merged_flag': 'String', 'minority_int': 'Float64', 'nca_within_1y': 'Float64', 'ncl_within_1y': 'Float64', 'notes_payable': 'Float64', 'notes_receiv': 'Float64', 'oil_and_gas_assets': 'String', 'ordin_risk_reser': 'String', 'oth_ca': 'Float64', 'oth_cl': 'Float64', 'oth_compre_income': 'Float64', 'oth_equity_instr': 'Float64', 'oth_nca': 'Float64', 'oth_ncl': 'Float64', 'oth_payable': 'Float64', 'oth_receiv': 'Float64', 'paid_in_capital': 'Float64', 'party_id': 'Int64', 'payroll_payable': 'Float64', 'perpetual_bond_e': 'String', 'perpetual_bond_l': 'String', 'preferred_stock_e': 'String', 'preferred_stock_l': 'String', 'premium_receiv': 'String', 'prepayment': 'Float64', 'produc_biol_assets': 'String', 'publish_date': 'String', 'pur_resale_fa': 'String', 'r_d': 'Float64', 'reinsur_payable': 'String', 'reinsur_receiv': 'String', 'reinsur_reser_receiv': 'String', 'report_type': 'String', 'retained_earnings': 'Float64', 'sec_full_name': 'String', 'sec_full_name_en': 'String', 'sec_short_name': 'String', 'sec_short_name_en': 'String', 'security_id': 'Int64', 'sett_prov': 'String', 'sold_for_repur_fa': 'String', 'special_reser': 'Float64', 'specific_payables': 'String', 'st_borr': 'Float64', 'surplus_reser': 'Float64', 't_assets': 'Float64', 't_ca': 'Float64', 't_cl': 'Float64', 't_equity_attr_p': 'Float64', 't_liab': 'Float64', 't_liab_equity': 'Float64', 't_nca': 'Float64', 't_ncl': 'Float64', 't_sh_equity': 'Float64', 'taxes_payable': 'Float64', 'ticker_symbol': 'String', 'tmstamp': 'Int64', 'trading_fa': 'Float64', 'trading_fl': 'Float64', 'trans_curr_cd': 'String', 'treasury_share': 'Float64', 'update_time': 'DateTime64'}

incomestatement:

[2022-08-26 18:48:45,947] [ERROR] IncomeStatement on 2022-08-24 00:00:00 daily_save error: 字段或者类型：{('assets_impair_loss', 'Float64'), ('int_income', 'Float64'), ('int_exp', 'Float64'), ('policy_div_payt', 'Float64'), ('reinsur_exp', 'Float64'), ('reser_insur_contr', 'Float64'), ('quit_concern_ni', 'Float64'), ('prem_refund', 'Float64'), ('commis_income', 'Float64'), ('prem_earned', 'Float64'), ('forex_gain', 'Float64'), ('commis_exp', 'Float64'), ('n_compens_payout', 'Float64')}与原数据表类型不匹配{'a_j_invest_income': 'Float64', 'accouting_standards': 'String', 'act_pubtime': 'DateTime64', 'admin_exp': 'Float64', 'asset_class': 'String', 'assets_disp_gain': 'Float64', 'assets_impair_loss': 'String', 'basic_eps': 'Float64', 'biz_tax_surchg': 'Float64', 'cn_spell': 'String', 'cogs': 'Float64', 'commis_exp': 'String', 'commis_income': 'String', 'compr_inc_attr_m_s': 'Float64', 'compr_inc_attr_p': 'Float64', 'currency_cd': 'String', 'delist_date': 'String', 'diluted_eps': 'Float64', 'dy_use_flg': 'Int64', 'end_date': 'DateTime64', 'end_date_rep': 'DateTime64', 'ex_country_cd': 'String', 'exchange_cd': 'String', 'f_value_chg_gain': 'Float64', 'finan_exp': 'Float64', 'fiscal_period': 'Int64', 'forex_gain': 'String', 'going_concern_ni': 'Float64', 'id': 'Int64', 'income_tax': 'Float64', 'int_exp': 'String', 'int_income': 'String', 'invest_income': 'Float64', 'list_date': 'DateTime64', 'list_status_cd': 'String', 'merged_flag': 'String', 'minority_gain': 'Float64', 'n_compens_payout': 'String', 'n_income': 'Float64', 'n_income_attr_p': 'Float64', 'nca_disploss': 'String', 'noperate_exp': 'Float64', 'noperate_income': 'Float64', 'operate_profit': 'Float64', 'oth_compr_income': 'Float64', 'oth_gain': 'Float64', 'party_id': 'Int64', 'policy_div_payt': 'String', 'prem_earned': 'String', 'prem_refund': 'String', 'publish_date': 'String', 'quit_concern_ni': 'String', 'reinsur_exp': 'String', 'report_type': 'String', 'reser_insur_contr': 'String', 'revenue': 'Float64', 'sec_full_name': 'String', 'sec_full_name_en': 'String', 'sec_short_name': 'String', 'sec_short_name_en': 'String', 'security_id': 'Int64', 'sell_exp': 'Float64', 't_cogs': 'Float64', 't_compr_income': 'Float64', 't_profit': 'Float64', 't_revenue': 'Float64', 'ticker_symbol': 'String', 'tmstamp': 'Int64', 'trans_curr_cd': 'String', 'update_time': 'DateTime64'}

[2022-08-26 18:48:46,778] [ERROR] IncomeStatementQPit on 2022-08-24 00:00:00 daily_save error: 字段或者类型：{('assets_impair_loss', 'Float64'), ('int_income', 'Float64'), ('int_exp', 'Float64'), ('policy_div_payt', 'Float64'), ('reinsur_exp', 'Float64'), ('quit_concern_ni', 'Float64'), ('prem_refund', 'Float64'), ('commis_income', 'Float64'), ('prem_earned', 'Float64'), ('forex_gain', 'Float64'), ('commis_exp', 'Float64')}与原数据表类型不匹配{'a_j_invest_income': 'Float64', 'admin_exp': 'Float64', 'asset_class': 'String', 'assets_disp_gain': 'Float64', 'assets_impair_loss': 'String', 'biz_tax_surchg': 'Float64', 'cn_spell': 'String', 'cogs': 'Float64', 'commis_exp': 'String', 'commis_income': 'String', 'compr_inc_attr_m_s': 'Float64', 'compr_inc_attr_p': 'Float64', 'delist_date': 'String', 'dy_use_flg': 'Int64', 'end_date': 'DateTime64', 'ex_country_cd': 'String', 'exchange_cd': 'String', 'f_value_chg_gain': 'Float64', 'finan_exp': 'Float64', 'forex_gain': 'String', 'going_concern_ni': 'Float64', 'id': 'Int64', 'income_tax': 'Float64', 'int_exp': 'String', 'int_income': 'String', 'invest_income': 'Float64', 'is_calc': 'Int64', 'is_new': 'Int64', 'list_date': 'DateTime64', 'list_status_cd': 'String', 'merged_flag': 'Int64', 'minority_gain': 'Float64', 'n_compens_payout': 'String', 'n_income': 'Float64', 'n_income_attr_p': 'Float64', 'nca_disploss': 'String', 'noperate_exp': 'Float64', 'noperate_income': 'Float64', 'operate_profit': 'Float64', 'oth_compr_income': 'Float64', 'oth_gain': 'Float64', 'party_id': 'Int64', 'policy_div_payt': 'String', 'prem_earned': 'String', 'prem_refund': 'String', 'publish_date': 'String', 'quit_concern_ni': 'String', 'reinsur_exp': 'String', 'reser_insur_contr': 'String', 'revenue': 'Float64', 'sec_full_name': 'String', 'sec_full_name_en': 'String', 'sec_short_name': 'String', 'sec_short_name_en': 'String', 'security_id': 'Int64', 'sell_exp': 'Float64', 't_cogs': 'Float64', 't_compr_income': 'Float64', 't_profit': 'Float64', 't_revenue': 'Float64', 'ticker_symbol': 'String', 'tmstamp': 'Int64', 'trans_curr_cd': 'String', 'update_time': 'DateTime64'}



[2022-08-26 18:48:48,293] [ERROR] IncomeStatementTtmPit on 2022-08-24 00:00:00 daily_save error: 字段或者类型：{('assets_impair_loss', 'Float64'), ('int_income', 'Float64'), ('int_exp', 'Float64'), ('policy_div_payt', 'Float64'), ('reinsur_exp', 'Float64'), ('quit_concern_ni', 'Float64'), ('prem_refund', 'Float64'), ('commis_income', 'Float64'), ('prem_earned', 'Float64'), ('forex_gain', 'Float64'), ('commis_exp', 'Float64')}与原数据表类型不匹配{'a_j_invest_income': 'Float64', 'admin_exp': 'Float64', 'asset_class': 'String', 'assets_disp_gain': 'Float64', 'assets_impair_loss': 'String', 'biz_tax_surchg': 'Float64', 'cn_spell': 'String', 'cogs': 'Float64', 'commis_exp': 'String', 'commis_income': 'String', 'compr_inc_attr_m_s': 'Float64', 'compr_inc_attr_p': 'Float64', 'delist_date': 'String', 'dy_use_flg': 'Int64', 'end_date': 'DateTime64', 'ex_country_cd': 'String', 'exchange_cd': 'String', 'f_value_chg_gain': 'Float64', 'finan_exp': 'Float64', 'forex_gain': 'String', 'going_concern_ni': 'Float64', 'id': 'Int64', 'income_tax': 'Float64', 'int_exp': 'String', 'int_income': 'String', 'invest_income': 'Float64', 'is_calc': 'Int64', 'is_new': 'Int64', 'list_date': 'DateTime64', 'list_status_cd': 'String', 'merged_flag': 'Int64', 'minority_gain': 'Float64', 'n_compens_payout': 'String', 'n_income': 'Float64', 'n_income_attr_p': 'Float64', 'nca_disploss': 'String', 'noperate_exp': 'Float64', 'noperate_income': 'Float64', 'operate_profit': 'Float64', 'oth_compr_income': 'Float64', 'oth_gain': 'Float64', 'party_id': 'Int64', 'policy_div_payt': 'String', 'prem_earned': 'String', 'prem_refund': 'String', 'publish_date': 'String', 'quit_concern_ni': 'String', 'reinsur_exp': 'String', 'reser_insur_contr': 'String', 'revenue': 'Float64', 'sec_full_name': 'String', 'sec_full_name_en': 'String', 'sec_short_name': 'String', 'sec_short_name_en': 'String', 'security_id': 'Int64', 'sell_exp': 'Float64', 't_cogs': 'Float64', 't_compr_income': 'Float64', 't_profit': 'Float64', 't_revenue': 'Float64', 'ticker_symbol': 'String', 'tmstamp': 'Int64', 'trans_curr_cd': 'String', 'update_time': 'DateTime64'}



\[2022-08-26 18:48:49,520] [ERROR] CashFlow on 2022-08-24 00:00:00 daily_save error: 字段或者类型：{('loan_to_oth_bank_fi', 'Float64'), ('preferred_stock_e', 'Float64'), ('pur_resale_fa', 'Float64'), ('perpetual_bond_e', 'Float64'), ('cb_borr', 'Float64'), ('specific_payables', 'Float64'), ('loan_fr_oth_bank_fi', 'Float64'), ('commis_payable', 'Float64'), ('depos', 'Float64'), ('preferred_stock_l', 'Float64'), ('insur_reser', 'Float64'), ('reinsur_payable', 'Float64'), ('funds_sec_trad_agen', 'Float64'), ('sold_for_repur_fa', 'Float64'), ('funds_sec_undw_agen', 'Float64'), ('reinsur_receiv', 'Float64'), ('produc_biol_assets', 'Float64'), ('premium_receiv', 'Float64'), ('reinsur_reser_receiv', 'Float64'), ('sett_prov', 'Float64'), ('ordin_risk_reser', 'Float64'), ('oil_and_gas_assets', 'Float64'), ('disbur_la', 'Float64'), ('perpetual_bond_l', 'Float64')}与原数据表类型不匹配{'accouting_standards': 'String', 'accrued_exp': 'String', 'act_pubtime': 'DateTime64', 'advance_receipts': 'Float64', 'ap': 'Float64', 'ar': 'Float64', 'asset_class': 'String', 'avail_for_sale_fa': 'String', 'bond_payable': 'Float64', 'capital_reser': 'Float64', 'cash_c_equiv': 'Float64', 'cb_borr': 'String', 'cip': 'Float64', 'cn_spell': 'String', 'commis_payable': 'String', 'const_materials': 'Float64', 'currency_cd': 'String', 'defer_revenue': 'Float64', 'defer_tax_assets': 'Float64', 'defer_tax_liab': 'Float64', 'delist_date': 'String', 'depos': 'String', 'disbur_la': 'String', 'div_payable': 'Float64', 'div_receiv': 'Float64', 'dy_use_flg': 'Int64', 'end_date': 'DateTime64', 'end_date_rep': 'DateTime64', 'estimated_liab': 'Float64', 'ex_country_cd': 'String', 'exchange_cd': 'String', 'fiscal_period': 'Int64', 'fixed_assets': 'Float64', 'fixed_assets_disp': 'Float64', 'forex_differ': 'String', 'funds_sec_trad_agen': 'String', 'funds_sec_undw_agen': 'String', 'goodwill': 'Float64', 'htm_invest': 'String', 'id': 'Int64', 'insur_reser': 'String', 'int_payable': 'Float64', 'int_receiv': 'Float64', 'intan_assets': 'Float64', 'inventories': 'Float64', 'invest_real_estate': 'Float64', 'list_date': 'DateTime64', 'list_status_cd': 'String', 'loan_fr_oth_bank_fi': 'String', 'loan_to_oth_bank_fi': 'String', 'lt_amor_exp': 'Float64', 'lt_borr': 'Float64', 'lt_equity_invest': 'Float64', 'lt_payable': 'Float64', 'lt_receiv': 'Float64', 'merged_flag': 'String', 'minority_int': 'Float64', 'nca_within_1y': 'Float64', 'ncl_within_1y': 'Float64', 'notes_payable': 'Float64', 'notes_receiv': 'Float64', 'oil_and_gas_assets': 'String', 'ordin_risk_reser': 'String', 'oth_ca': 'Float64', 'oth_cl': 'Float64', 'oth_compre_income': 'Float64', 'oth_equity_instr': 'Float64', 'oth_nca': 'Float64', 'oth_ncl': 'Float64', 'oth_payable': 'Float64', 'oth_receiv': 'Float64', 'paid_in_capital': 'Float64', 'party_id': 'Int64', 'payroll_payable': 'Float64', 'perpetual_bond_e': 'String', 'perpetual_bond_l': 'String', 'preferred_stock_e': 'String', 'preferred_stock_l': 'String', 'premium_receiv': 'String', 'prepayment': 'Float64', 'produc_biol_assets': 'String', 'publish_date': 'String', 'pur_resale_fa': 'String', 'r_d': 'Float64', 'reinsur_payable': 'String', 'reinsur_receiv': 'String', 'reinsur_reser_receiv': 'String', 'report_type': 'String', 'retained_earnings': 'Float64', 'sec_full_name': 'String', 'sec_full_name_en': 'String', 'sec_short_name': 'String', 'sec_short_name_en': 'String', 'security_id': 'Int64', 'sett_prov': 'String', 'sold_for_repur_fa': 'String', 'special_reser': 'Float64', 'specific_payables': 'String', 'st_borr': 'Float64', 'surplus_reser': 'Float64', 't_assets': 'Float64', 't_ca': 'Float64', 't_cl': 'Float64', 't_equity_attr_p': 'Float64', 't_liab': 'Float64', 't_liab_equity': 'Float64', 't_nca': 'Float64', 't_ncl': 'Float64', 't_sh_equity': 'Float64', 'taxes_payable': 'Float64', 'ticker_symbol': 'String', 'tmstamp': 'Int64', 'trading_fa': 'Float64', 'trading_fl': 'Float64', 'trans_curr_cd': 'String', 'treasury_share': 'Float64', 'update_time': 'DateTime64'}



[2022-08-26 18:48:50,413] [ERROR] CashFlowQPit on 2022-08-24 00:00:00 daily_save error: 字段或者类型：{('ifc_cash_incr', 'Float64'), ('n_cap_incr_repur', 'Float64'), ('net_incr_depos_in_fi', 'Float64'), ('c_paid_ifc', 'Float64'), ('n_inc_disbur_of_la', 'Float64'), ('prem_fr_orig_contr', 'Float64'), ('n_depos_incr_c_fi', 'Float64'), ('n_inc_ph_depos_inv', 'Float64'), ('n_inc_fr_borr', 'Float64'), ('c_fr_issue_bond', 'Float64'), ('n_incr_pledge_loan', 'Float64'), ('n_incr_borr_fr_cb', 'Float64'), ('orig_contr_c_indem', 'Float64'), ('c_paid_pol_div', 'Float64'), ('n_inc_borr_oth_fi', 'Float64')}与原数据表类型不匹配{'asset_class': 'String', 'c_fr_borr': 'Float64', 'c_fr_cap_contr': 'Float64', 'c_fr_issue_bond': 'String', 'c_fr_mino_s_subs': 'Float64', 'c_fr_oth_finan_a': 'Float64', 'c_fr_oth_invest_a': 'Float64', 'c_fr_oth_operate_a': 'Float64', 'c_fr_sale_g_s': 'Float64', 'c_inf_fr_finan_a': 'Float64', 'c_inf_fr_invest_a': 'Float64', 'c_inf_fr_operate_a': 'Float64', 'c_outf_fr_finan_a': 'Float64', 'c_outf_fr_invest_a': 'Float64', 'c_outf_operate_a': 'Float64', 'c_paid_div_prof_int': 'Float64', 'c_paid_for_debts': 'Float64', 'c_paid_for_oth_op_a': 'Float64', 'c_paid_for_taxes': 'Float64', 'c_paid_g_s': 'Float64', 'c_paid_ifc': 'String', 'c_paid_invest': 'Float64', 'c_paid_oth_finan_a': 'Float64', 'c_paid_oth_invest_a': 'Float64', 'c_paid_pol_div': 'String', 'c_paid_to_for_empl': 'Float64', 'cn_spell': 'String', 'delist_date': 'String', 'disp_fix_assets_oth': 'Float64', 'div_prof_subs_mino_s': 'Float64', 'dy_use_flg': 'Int64', 'end_date': 'DateTime64', 'ex_country_cd': 'String', 'exchange_cd': 'String', 'forex_effects': 'Float64', 'gain_invest': 'Float64', 'id': 'Int64', 'ifc_cash_incr': 'String', 'is_calc': 'Int64', 'is_new': 'Int64', 'list_date': 'DateTime64', 'list_status_cd': 'String', 'merged_flag': 'Int64', 'n_c_paid_acquis': 'Float64', 'n_cap_incr_repur': 'String', 'n_ce_beg_bal': 'Float64', 'n_ce_end_bal': 'Float64', 'n_cf_fr_finan_a': 'Float64', 'n_cf_fr_invest_a': 'Float64', 'n_cf_operate_a': 'Float64', 'n_change_in_cash': 'Float64', 'n_depos_incr_c_fi': 'String', 'n_disp_subs_oth_biz_c': 'Float64', 'n_inc_borr_oth_fi': 'String', 'n_inc_disbur_of_la': 'String', 'n_inc_disp_trad_fa': 'String', 'n_inc_fr_borr': 'String', 'n_inc_ph_depos_inv': 'String', 'n_incr_borr_fr_cb': 'String', 'n_incr_pledge_loan': 'String', 'n_reinsur_prem': 'String', 'net_incr_depos_in_fi': 'String', 'orig_contr_c_indem': 'String', 'party_id': 'Int64', 'prem_fr_orig_contr': 'String', 'proc_sell_invest': 'Float64', 'publish_date': 'String', 'pur_fix_assets_oth': 'Float64', 'refund_of_tax': 'Float64', 'sec_full_name': 'String', 'sec_full_name_en': 'String', 'sec_short_name': 'String', 'sec_short_name_en': 'String', 'security_id': 'Int64', 'ticker_symbol': 'String', 'tmstamp': 'Int64', 'trans_curr_cd': 'String', 'update_time': 'DateTime64'}



[2022-08-26 18:48:51,336] [ERROR] CashFlowTtmPit on 2022-08-24 00:00:00 daily_save error: 字段或者类型：{('ifc_cash_incr', 'Float64'), ('n_cap_incr_repur', 'Float64'), ('net_incr_depos_in_fi', 'Float64'), ('c_paid_ifc', 'Float64'), ('n_inc_disbur_of_la', 'Float64'), ('prem_fr_orig_contr', 'Float64'), ('n_depos_incr_c_fi', 'Float64'), ('n_inc_ph_depos_inv', 'Float64'), ('n_inc_fr_borr', 'Float64'), ('n_inc_disp_trad_fa', 'Float64'), ('c_fr_issue_bond', 'Float64'), ('n_incr_pledge_loan', 'Float64'), ('n_incr_borr_fr_cb', 'Float64'), ('orig_contr_c_indem', 'Float64'), ('c_paid_pol_div', 'Float64'), ('n_inc_borr_oth_fi', 'Float64')}与原数据表类型不匹配{'asset_class': 'String', 'c_fr_borr': 'Float64', 'c_fr_cap_contr': 'Float64', 'c_fr_issue_bond': 'String', 'c_fr_mino_s_subs': 'Float64', 'c_fr_oth_finan_a': 'Float64', 'c_fr_oth_invest_a': 'Float64', 'c_fr_oth_operate_a': 'Float64', 'c_fr_sale_g_s': 'Float64', 'c_inf_fr_finan_a': 'Float64', 'c_inf_fr_invest_a': 'Float64', 'c_inf_fr_operate_a': 'Float64', 'c_outf_fr_finan_a': 'Float64', 'c_outf_fr_invest_a': 'Float64', 'c_outf_operate_a': 'Float64', 'c_paid_div_prof_int': 'Float64', 'c_paid_for_debts': 'Float64', 'c_paid_for_oth_op_a': 'Float64', 'c_paid_for_taxes': 'Float64', 'c_paid_g_s': 'Float64', 'c_paid_ifc': 'String', 'c_paid_invest': 'Float64', 'c_paid_oth_finan_a': 'Float64', 'c_paid_oth_invest_a': 'Float64', 'c_paid_pol_div': 'String', 'c_paid_to_for_empl': 'Float64', 'cn_spell': 'String', 'delist_date': 'String', 'disp_fix_assets_oth': 'Float64', 'div_prof_subs_mino_s': 'Float64', 'dy_use_flg': 'Int64', 'end_date': 'DateTime64', 'ex_country_cd': 'String', 'exchange_cd': 'String', 'forex_effects': 'Float64', 'gain_invest': 'Float64', 'id': 'Int64', 'ifc_cash_incr': 'String', 'is_calc': 'Int64', 'is_new': 'Int64', 'list_date': 'DateTime64', 'list_status_cd': 'String', 'merged_flag': 'Int64', 'n_c_paid_acquis': 'Float64', 'n_cap_incr_repur': 'String', 'n_ce_beg_bal': 'Float64', 'n_ce_end_bal': 'Float64', 'n_cf_fr_finan_a': 'Float64', 'n_cf_fr_invest_a': 'Float64', 'n_cf_operate_a': 'Float64', 'n_change_in_cash': 'Float64', 'n_depos_incr_c_fi': 'String', 'n_disp_subs_oth_biz_c': 'Float64', 'n_inc_borr_oth_fi': 'String', 'n_inc_disbur_of_la': 'String', 'n_inc_disp_trad_fa': 'String', 'n_inc_fr_borr': 'String', 'n_inc_ph_depos_inv': 'String', 'n_incr_borr_fr_cb': 'String', 'n_incr_pledge_loan': 'String', 'n_reinsur_prem': 'String', 'net_incr_depos_in_fi': 'String', 'orig_contr_c_indem': 'String', 'party_id': 'Int64', 'prem_fr_orig_contr': 'String', 'proc_sell_invest': 'Float64', 'publish_date': 'String', 'pur_fix_assets_oth': 'Float64', 'refund_of_tax': 'Float64', 'sec_full_name': 'String', 'sec_full_name_en': 'String', 'sec_short_name': 'String', 'sec_short_name_en': 'String', 'security_id': 'Int64', 'ticker_symbol': 'String', 'tmstamp': 'Int64', 'trans_curr_cd': 'String', 'update_time': 'DateTime64'}



[2022-08-26 18:48:52,820] [ERROR] MainDataPit on 2022-08-24 00:00:00 daily_save error: 字段或者类型：{('eps_cut_yoy', 'String')}与原数据表类型不匹配{'act_pubtime': 'DateTime64', 'admin_exp_tr': 'Float64', 'adv_r_r': 'Float64', 'adv_r_ta': 'Float64', 'ail_tr': 'Float64', 'ap_ta': 'Float64', 'ap_turnover': 'Float64', 'ar_r': 'Float64', 'ar_rec_r': 'Float64', 'ar_ta': 'Float64', 'ar_turnover': 'Float64', 'asset_class': 'String', 'asset_liab_ratio': 'Float64', 'basic_eps': 'Float64', 'basic_eps_cut': 'Float64', 'basic_eps_yoy': 'Float64', 'bp_ta': 'Float64', 'btax_surchg_tr': 'Float64', 'c_fr_sale_g_s_yoy': 'Float64', 'c_p_to_for_empl_yoy': 'Float64', 'c_paid_g_s_yoy': 'Float64', 'c_rcvry_a': 'Float64', 'c_reser_ps': 'Float64', 'c_ta': 'Float64', 'ca_ta': 'Float64', 'ca_turnover': 'Float64', 'cap_fix_ratio': 'Float64', 'cash_ce_ytd': 'Float64', 'cash_cl': 'Float64', 'cash_div_cover': 'Float64', 'cash_icl': 'Float64', 'cash_m_inv_ratio': 'Float64', 'cash_oper_ratio': 'Float64', 'cash_ratio': 'Float64', 'cfsgs_r': 'Float64', 'cil_tr': 'Float64', 'cl_ta': 'Float64', 'cl_teap': 'Float64', 'cn_spell': 'String', 'cogs_tr': 'Float64', 'cogs_yoy': 'Float64', 'current_ratio': 'Float64', 'da': 'Float64', 'day_fa': 'Float64', 'day_tfa': 'Float64', 'days_ap': 'Float64', 'days_ar': 'Float64', 'days_inven': 'Float64', 'days_n_work_capital': 'Float64', 'days_np_ap': 'Float64', 'days_nr_ar': 'Float64', 'days_work_capital': 'Float64', 'delist_date': 'String', 'diluted_eps': 'Float64', 'diluted_eps_cut': 'Float64', 'diluted_eps_yoy': 'Float64', 'dy_use_flg': 'Int64', 'ebiat': 'Float64', 'ebit': 'Float64', 'ebit_ps': 'Float64', 'ebit_tr': 'Float64', 'ebitda': 'Float64', 'ebitda_id': 'Float64', 'ebitda_ps': 'Float64', 'ebitda_tl': 'Float64', 'ebitda_tr': 'Float64', 'end_date': 'DateTime64', 'end_date_rep': 'DateTime64', 'eps': 'Float64', 'eps_cut': 'Float64', 'eps_cut_yoy': 'Float64', 'eps_yoy': 'Float64', 'equ_multiplier': 'Float64', 'equity_ratio': 'Float64', 'ex_country_cd': 'String', 'exchange_cd': 'String', 'fa_turnover': 'Float64', 'fcfe': 'Float64', 'fcfe_ps': 'Float64', 'fcff': 'Float64', 'fcff_ps': 'Float64', 'finan_exp_tr': 'Float64', 'fiscal_period': 'Int64', 'fixed_a_t_ta': 'Float64', 'fv_chg_g_tr': 'Float64', 'gross_margin': 'Float64', 'gross_profit': 'Float64', 'gross_profit_yoy': 'Float64', 'ic': 'Float64', 'id': 'Int64', 'id_ic': 'Float64', 'int_cl': 'Float64', 'int_debt': 'Float64', 'int_free_cl': 'Float64', 'int_free_ncl': 'Float64', 'intan_a_ta': 'Float64', 'inv_inc_tr': 'Float64', 'inven_ta': 'Float64', 'inven_turnover': 'Float64', 'is_new': 'Int64', 'it_tp': 'Float64', 'it_tr': 'Float64', 'list_date': 'DateTime64', 'list_status_cd': 'String', 'lt_amor_exp_ta': 'Float64', 'lt_asset_suit_ratio': 'Float64', 'lt_borr_ta': 'Float64', 'lt_debt_cap_ratio': 'Float64', 'lt_liab_ratio': 'Float64', 'merged_flag': 'String', 'n_asset_ps': 'Float64', 'n_c_in_cash_ps': 'Float64', 'n_cf_fa_propt': 'Float64', 'n_cf_ia_propt': 'Float64', 'n_cf_nfa_cl': 'Float64', 'n_cf_nfa_liab': 'Float64', 'n_cf_opa_cl': 'Float64', 'n_cf_opa_debt_due': 'Float64', 'n_cf_opa_id': 'Float64', 'n_cf_opa_liab': 'Float64', 'n_cf_opa_ncl': 'Float64', 'n_cf_opa_nd': 'Float64', 'n_cf_opa_nia': 'Float64', 'n_cf_opa_nia_yoy': 'Float64', 'n_cf_opa_op': 'Float64', 'n_cf_opa_opap': 'Float64', 'n_cf_opa_propt': 'Float64', 'n_cf_opa_ps_yoy': 'Float64', 'n_cf_opa_r': 'Float64', 'n_cf_opa_tr': 'Float64', 'n_cf_opa_yoy': 'Float64', 'n_cf_oper_a_ps': 'Float64', 'n_debt': 'Float64', 'n_int_exp': 'Float64', 'n_nopi_tp': 'Float64', 'n_oper_cycle': 'Float64', 'n_tan_a_id': 'Float64', 'n_tan_a_nd': 'Float64', 'n_tan_a_ta': 'Float64', 'n_tan_a_tl': 'Float64', 'n_tan_assets': 'Float64', 'n_work_capital': 'Float64', 'n_work_capital_turnover': 'Float64', 'na_ps_ytd': 'Float64', 'na_ytd': 'Float64', 'nca_ta': 'Float64', 'nca_turnover': 'Float64', 'ncl_ta': 'Float64', 'ncl_teap': 'Float64', 'ncl_wc': 'Float64', 'ni_attr_p_cut': 'Float64', 'ni_attr_p_cut_yoy': 'Float64', 'ni_attr_p_yoy': 'Float64', 'ni_cut_ni': 'Float64', 'ni_tr': 'Float64', 'ni_yoy': 'Float64', 'nopg_tr': 'Float64', 'nopl_tr': 'Float64', 'np_ap_ta': 'Float64', 'np_ap_turnover': 'Float64', 'np_margin': 'Float64', 'np_margin_yoy': 'Float64', 'nr_ar_r': 'Float64', 'nr_ar_rec_r': 'Float64', 'nr_ar_ta': 'Float64', 'nr_ar_turnover': 'Float64', 'nr_profit_loss': 'Float64', 'op_cl': 'Float64', 'op_ps': 'Float64', 'op_tl': 'Float64', 'op_tp': 'Float64', 'op_tr': 'Float64', 'opa_p_tp': 'Float64', 'opa_p_tr': 'Float64', 'opa_profit': 'Float64', 'oper_cycle': 'Float64', 'oper_profit_yoy': 'Float64', 'p_cost_exp': 'Float64', 'p_fixa_o_da': 'Float64', 'party_id': 'Int64', 'period_exp_tr': 'Float64', 'publish_date': 'String', 'quick_ratio': 'Float64', 'r_d_exp_tr': 'Float64', 'r_d_exp_yoy': 'Float64', 'r_tr': 'Float64', 'rd': 'Float64', 'rd_e_ni_attr_p_cut': 'Float64', 're_ps': 'Float64', 'repay_ta': 'Float64', 'report_type': 'String', 'reser_ps': 'Float64', 'rev_ps': 'Float64', 'revenue_yoy': 'Float64', 'roa': 'Float64', 'roa_ebit': 'Float64', 'roe': 'Float64', 'roe_a': 'Float64', 'roe_cut': 'Float64', 'roe_cut_a': 'Float64', 'roe_cut_w': 'Float64', 'roe_w': 'Float64', 'roe_yoy': 'Float64', 'roic': 'Float64', 'rop': 'Float64', 's_reser_ps': 'Float64', 'sc_ratio': 'Float64', 'sec_full_name': 'String', 'sec_full_name_en': 'String', 'sec_short_name': 'String', 'sec_short_name_en': 'String', 'security_id': 'Int64', 'sell_exp_tr': 'Float64', 'squick_ratio': 'Float64', 'st_borr_ta': 'Float64', 't_fa_ytd': 'Float64', 't_fixed_a_ta': 'Float64', 't_fixed_assets': 'Float64', 't_profit_yoy': 'Float64', 't_re': 'Float64', 't_re_ps': 'Float64', 't_rev_ps': 'Float64', 't_revenue_yoy': 'Float64', 'ta_turnover': 'Float64', 'ta_ytd': 'Float64', 'tcogs_tr': 'Float64', 'te_attr_p_ytd': 'Float64', 'teap_ic': 'Float64', 'teap_id': 'Float64', 'teap_ta': 'Float64', 'teap_tl': 'Float64', 'tfa_turnover': 'Float64', 'ticker_symbol': 'String', 'times_inte_cf': 'Float64', 'times_inte_ebit': 'Float64', 'times_inte_ebitda': 'Float64', 'tl_teap': 'Float64', 'tl_ytd': 'Float64', 'tmstamp': 'Int64', 'tp_tr': 'Float64', 'trans_curr_cd': 'String', 'tre_ta': 'Float64', 'tse_ta': 'Float64', 'update_time': 'DateTime64', 'val_chg_p_tp': 'Float64', 'val_chg_p_tr': 'Float64', 'val_chg_profit': 'Float64', 'work_capital': 'Float64', 'work_capital_turnover': 'Float64'}





[2022-08-26 18:48:55,202] [ERROR] EePit on 2022-08-24 00:00:00 daily_save error: 字段或者类型：{('eps_w', 'String'), ('eps_w_yoy', 'String'), ('eps_w_ly', 'String')}与原数据表类型不匹配{'accouting_standards': 'String', 'act_pubtime': 'DateTime64', 'asset_class': 'String', 'basic_eps': 'Float64', 'basic_eps_ly': 'Float64', 'basic_eps_yoy': 'Float64', 'cn_spell': 'String', 'currency_cd': 'String', 'delist_date': 'String', 'dy_use_flg': 'Int64', 'end_date': 'DateTime64', 'eps_cut': 'String', 'eps_cut_ly': 'String', 'eps_cut_w': 'String', 'eps_cut_w_ly': 'String', 'eps_cut_w_yoy': 'String', 'eps_cut_yoy': 'String', 'eps_w': 'Float64', 'eps_w_ly': 'Float64', 'eps_w_yoy': 'Float64', 'ex_country_cd': 'String', 'exchange_cd': 'String', 'fiscal_period': 'String', 'gross_profit': 'String', 'gross_profit_ly': 'String', 'gross_profit_yoy': 'String', 'id': 'Int64', 'list_date': 'DateTime64', 'list_status_cd': 'String', 'merged_flag': 'String', 'n_asset_ps': 'Float64', 'n_asset_ps_ly': 'Float64', 'n_asset_ps_yoy': 'Float64', 'n_cf_oper_a': 'String', 'n_cf_oper_a_ly': 'String', 'n_cf_oper_a_ps': 'String', 'n_cf_oper_a_ps_ly': 'String', 'n_cf_oper_a_ps_yoy': 'String', 'n_cf_oper_a_yoy': 'String', 'n_income_attr_p': 'Float64', 'n_income_attr_p_ly': 'Float64', 'n_income_attr_p_yoy': 'Float64', 'n_income_cut': 'Float64', 'n_income_cut_ly': 'Float64', 'n_income_cut_yoy': 'Float64', 'oper_profit_ly': 'Float64', 'oper_profit_yoy': 'Float64', 'operate_profit': 'Float64', 'opr_fin_exp': 'String', 'paid_in_capital': 'Float64', 'party_id': 'Int64', 'prime_oper_rev': 'String', 'prime_oper_rev_ly': 'String', 'prime_oper_rev_yoy': 'String', 'publish_date': 'String', 'report_type': 'String', 'revenue': 'Float64', 'revenue_ly': 'Float64', 'revenue_yoy': 'Float64', 'roe': 'Float64', 'roe_cut': 'Float64', 'roe_cut_ly': 'String', 'roe_cut_w': 'String', 'roe_cut_w_ly': 'String', 'roe_cut_w_yoy': 'String', 'roe_cut_yoy': 'String', 'roe_ly': 'String', 'roe_w': 'Float64', 'roe_w_ly': 'Float64', 'roe_w_yoy': 'Float64', 'roe_yoy': 'String', 'sec_full_name': 'String', 'sec_full_name_en': 'String', 'sec_short_name': 'String', 'sec_short_name_en': 'String', 'security_id': 'Int64', 't_assets': 'Float64', 't_assets_ly': 'Float64', 't_assets_yoy': 'Float64', 't_equity_attr_p': 'Float64', 't_equity_attr_p_ly': 'Float64', 't_equity_attr_p_yoy': 'Float64', 't_profit': 'Float64', 't_profit_ly': 'Float64', 't_profit_yoy': 'Float64', 'ticker_symbol': 'String', 'tmstamp': 'Int64', 'trans_curr_cd': 'String', 'update_time': 'DateTime64'}



[2022-08-26 18:49:39,758] [ERROR] Fin_Income_Gen on 2022-08-25 00:00:00 daily_save error: 字段或者类型：{('tor4', 'Float64'), ('toc2', 'Float64'), ('toc4', 'Float64'), ('loss_credit', 'Float64'), ('toc3', 'Float64'), ('toc7', 'Float64'), ('toc8', 'Float64'), ('toc6', 'Float64'), ('toc5', 'Float64'), ('tor3', 'Float64'), ('gain_exch', 'Float64')}与原数据表类型不匹配{'bas_eps': 'Float64', 'company_code': 'String', 'declare_date': 'DateTime64', 'dil_eps': 'Float64', 'entrytime': 'String', 'gain_exch': 'String', 'gain_fv': 'Float64', 'gain_net_eh': 'Float64', 'gain_non_ca': 'String', 'gain_other': 'Float64', 'gain_ta': 'Float64', 'inve_income': 'Float64', 'inve_income_joint': 'Float64', 'ite': 'Float64', 'loss_credit': 'String', 'loss_non_ca': 'String', 'loss_ta': 'Float64', 'non_oe': 'Float64', 'non_op': 'Float64', 'np': 'Float64', 'np_continuous': 'Float64', 'np_minority': 'Float64', 'np_shareholder': 'Float64', 'np_termination': 'Float64', 'op': 'Float64', 'other_np': 'Float64', 'other_np1': 'Float64', 'other_np11': 'Float64', 'other_np111': 'Float64', 'other_np112': 'Float64', 'other_np12': 'Float64', 'other_np121': 'Float64', 'other_np122': 'String', 'other_np123': 'String', 'other_np124': 'String', 'other_np125': 'Float64', 'other_np126': 'Float64', 'other_np2': 'Float64', 'report_quarter': 'Int64', 'report_type': 'Int64', 'report_year': 'Int64', 'stock_code': 'String', 'stock_name': 'String', 'tci': 'Float64', 'tci_monority': 'Float64', 'tci_parent': 'Float64', 'tmstamp': 'Int64', 'toc': 'Float64', 'toc1': 'Float64', 'toc10': 'Float64', 'toc11': 'Float64', 'toc12': 'Float64', 'toc13': 'String', 'toc14': 'Float64', 'toc14_1': 'Float64', 'toc14_2': 'Float64', 'toc2': 'String', 'toc3': 'String', 'toc4': 'String', 'toc5': 'String', 'toc6': 'String', 'toc7': 'String', 'toc8': 'String', 'toc9': 'Float64', 'tor': 'Float64', 'tor1': 'Float64', 'tor2': 'Float64', 'tor3': 'String', 'tor4': 'String', 'tp': 'Float64', 'updatetime': 'String'}



[2022-08-26 18:49:41,315] [ERROR] Fin_Balance_Sheet_Gen on 2022-08-25 00:00:00 daily_save error: 字段或者类型：{('tse_pa4', 'Float64'), ('tl_cl8', 'Float64'), ('tl_ncl4', 'Float64'), ('tse_pa3', 'Float64'), ('tl_cl7', 'Float64'), ('tl_ncl3', 'Float64'), ('ta_ca9', 'Float64'), ('ta_nca11', 'Float64')}与原数据表类型不匹配{'company_code': 'String', 'declare_date': 'DateTime64', 'entrytime': 'String', 'report_quarter': 'Int64', 'report_type': 'Int64', 'report_year': 'Int64', 'stock_code': 'String', 'stock_name': 'String', 'ta': 'Float64', 'ta_ca': 'Float64', 'ta_ca1': 'Float64', 'ta_ca10': 'Float64', 'ta_ca11': 'Float64', 'ta_ca12': 'Float64', 'ta_ca13': 'Float64', 'ta_ca14': 'Float64', 'ta_ca16': 'Float64', 'ta_ca17': 'Float64', 'ta_ca18': 'Float64', 'ta_ca19': 'Float64', 'ta_ca2': 'Float64', 'ta_ca3': 'Float64', 'ta_ca4': 'Float64', 'ta_ca5': 'Float64', 'ta_ca6': 'Float64', 'ta_ca7': 'Float64', 'ta_ca8': 'Float64', 'ta_ca9': 'String', 'ta_nca': 'Float64', 'ta_nca1': 'String', 'ta_nca10': 'Float64', 'ta_nca11': 'String', 'ta_nca12': 'Float64', 'ta_nca13': 'Float64', 'ta_nca14': 'Float64', 'ta_nca15': 'Float64', 'ta_nca16': 'Float64', 'ta_nca17': 'Float64', 'ta_nca2': 'Float64', 'ta_nca3': 'Float64', 'ta_nca4': 'Float64', 'ta_nca5': 'Float64', 'ta_nca6': 'Float64', 'ta_nca7': 'Float64', 'ta_nca8': 'Float64', 'ta_nca9': 'Float64', 'tl': 'Float64', 'tl_cl': 'Float64', 'tl_cl1': 'Float64', 'tl_cl10': 'Float64', 'tl_cl11': 'Float64', 'tl_cl12': 'Float64', 'tl_cl13': 'Float64', 'tl_cl14': 'Float64', 'tl_cl15': 'Float64', 'tl_cl16': 'Float64', 'tl_cl17': 'Float64', 'tl_cl18': 'Float64', 'tl_cl19': 'String', 'tl_cl2': 'Float64', 'tl_cl20': 'Float64', 'tl_cl21': 'Float64', 'tl_cl3': 'Float64', 'tl_cl4': 'Float64', 'tl_cl5': 'Float64', 'tl_cl6': 'Float64', 'tl_cl7': 'String', 'tl_cl8': 'String', 'tl_cl9': 'Float64', 'tl_ncl': 'Float64', 'tl_ncl1': 'Float64', 'tl_ncl10': 'Float64', 'tl_ncl11': 'Float64', 'tl_ncl2': 'Float64', 'tl_ncl3': 'String', 'tl_ncl4': 'String', 'tl_ncl5': 'Float64', 'tl_ncl6': 'Float64', 'tl_ncl7': 'Float64', 'tl_ncl8': 'Float64', 'tl_ncl9': 'Float64', 'tlse': 'Float64', 'tmstamp': 'Int64', 'tse': 'Float64', 'tse_monority': 'Float64', 'tse_pa1': 'Float64', 'tse_pa10': 'Float64', 'tse_pa11': 'Float64', 'tse_pa2': 'Float64', 'tse_pa3': 'String', 'tse_pa4': 'String', 'tse_pa5': 'Float64', 'tse_pa6': 'Float64', 'tse_pa7': 'Float64', 'tse_pa8': 'Float64', 'tse_pa9': 'Float64', 'tse_parent': 'Float64', 'updatetime': 'String'}



[2022-08-26 18:49:42,573] [ERROR] Fin_Cash_Flow_Gen on 2022-08-25 00:00:00 daily_save error: 字段或者类型：{('ncf_fa14', 'Float64'), ('ncf_ia23', 'Float64')}与原数据表类型不匹配{'begin_cf': 'Float64', 'company_code': 'String', 'declare_date': 'DateTime64', 'end_cf': 'Float64', 'entrytime': 'String', 'gain_exch': 'Float64', 'ncf': 'Float64', 'ncf_fa': 'Float64', 'ncf_fa1': 'Float64', 'ncf_fa11': 'Float64', 'ncf_fa12': 'Float64', 'ncf_fa13': 'Float64', 'ncf_fa14': 'String', 'ncf_fa15': 'Float64', 'ncf_fa2': 'Float64', 'ncf_fa21': 'Float64', 'ncf_fa22': 'Float64', 'ncf_fa23': 'Float64', 'ncf_fa24': 'Float64', 'ncf_ia': 'Float64', 'ncf_ia1': 'Float64', 'ncf_ia11': 'Float64', 'ncf_ia12': 'Float64', 'ncf_ia13': 'Float64', 'ncf_ia14': 'Float64', 'ncf_ia15': 'Float64', 'ncf_ia2': 'Float64', 'ncf_ia21': 'Float64', 'ncf_ia22': 'Float64', 'ncf_ia23': 'String', 'ncf_ia24': 'Float64', 'ncf_ia25': 'Float64', 'ncf_oa': 'Float64', 'ncf_oa1': 'Float64', 'ncf_oa11': 'Float64', 'ncf_oa12': 'Float64', 'ncf_oa13': 'Float64', 'ncf_oa2': 'Float64', 'ncf_oa21': 'Float64', 'ncf_oa22': 'Float64', 'ncf_oa23': 'Float64', 'ncf_oa24': 'Float64', 'report_quarter': 'Int64', 'report_type': 'Int64', 'report_year': 'Int64', 'stock_code': 'String', 'stock_name': 'String', 'tmstamp': 'Int64', 'updatetime': 'String'}



[2022-08-26 18:49:45,361] [ERROR] Fin_Main_Ratio on 2022-08-25 00:00:00 daily_save error: 字段或者类型：{('fa_grate_qoq', 'Float64')}与原数据表类型不匹配{'ar_turnover': 'Float64', 'ca_ratio': 'Float64', 'ca_turnover': 'Float64', 'cash_ratio': 'Float64', 'cd_ratio': 'Float64', 'company_code': 'String', 'cur_ratio': 'Float64', 'debt_as_ratio': 'Float64', 'debt_eq_ratio': 'Float64', 'declare_date': 'DateTime64', 'ds_ratio': 'Float64', 'entrytime': 'String', 'eq_as_ratio': 'Float64', 'eq_multiplier': 'Float64', 'exp_ratio': 'Float64', 'fa_grate_qoq': 'String', 'fa_grate_yoy': 'Float64', 'fa_ratio': 'Float64', 'fa_turnover': 'Float64', 'fe_ratio': 'Float64', 'gp_ratio': 'Float64', 'icfoa_or_ratio': 'Float64', 'icfoa_or_ratio_ttm': 'Float64', 'int_multiplier': 'Float64', 'inv_ratio': 'Float64', 'inv_turnover': 'Float64', 'man_ratio': 'Float64', 'mar_ratio': 'Float64', 'mf_ratio': 'Float64', 'na_grate_qoq': 'Float64', 'na_grate_yoy': 'Float64', 'na_turnover': 'Float64', 'ncf_ta_ratio': 'Float64', 'ncf_ta_ratio_ttm': 'Float64', 'ncfoa_cl_ratio': 'Float64', 'ncfoa_np_ratio': 'Float64', 'ncfoa_np_ratio_ttm': 'Float64', 'ncfoa_or_ratio': 'Float64', 'ncfoa_or_ratio_ttm': 'Float64', 'ncfoa_tl_ratio': 'Float64', 'nf_margin': 'Float64', 'np_grate_qoq': 'Float64', 'np_grate_yoy': 'Float64', 'op_grate_qoq': 'Float64', 'op_grate_yoy': 'Float64', 'or_grate_qoq': 'Float64', 'or_grate_yoy': 'Float64', 'quick_ratio': 'Float64', 'report_quarter': 'Int64', 'report_type': 'Int64', 'report_year': 'Int64', 'roa': 'Float64', 'roa_exeal': 'Float64', 'roe': 'Float64', 'roe_exeal': 'Float64', 'stock_code': 'String', 'stock_name': 'String', 'ta_grate_qoq': 'Float64', 'ta_grate_yoy': 'Float64', 'ta_turnover': 'Float64', 'tma_tatio': 'Float64', 'tmstamp': 'Int64', 'tp_ce_ratio': 'Float64', 'updatetime': 'String', 'wc_turnover': 'Float64'}



[2022-08-26 18:49:46,987] [ERROR] Fin_Balance_Sheet_Ttm on 2022-08-25 00:00:00 daily_save error: 字段或者类型：{('tse_pa4', 'Float64'), ('tl_cl8', 'Float64'), ('tl_cl14', 'Float64'), ('tl_ncl4', 'Float64'), ('tse_pa3', 'Float64'), ('tl_cl7', 'Float64'), ('tl_ncl3', 'Float64'), ('ta_ca9', 'Float64'), ('ta_nca11', 'Float64')}与原数据表类型不匹配{'begin_date': 'DateTime64', 'company_code': 'String', 'end_date': 'DateTime64', 'entrytime': 'String', 'report_quarter': 'String', 'report_type': 'Int64', 'report_year': 'Int64', 'stock_code': 'String', 'stock_name': 'String', 'ta': 'Float64', 'ta_ca': 'Float64', 'ta_ca1': 'Float64', 'ta_ca10': 'Float64', 'ta_ca11': 'Float64', 'ta_ca12': 'Float64', 'ta_ca13': 'Float64', 'ta_ca2': 'Float64', 'ta_ca3': 'Float64', 'ta_ca4': 'Float64', 'ta_ca5': 'Float64', 'ta_ca6': 'Float64', 'ta_ca7': 'Float64', 'ta_ca8': 'Float64', 'ta_ca9': 'String', 'ta_nca': 'Float64', 'ta_nca1': 'String', 'ta_nca10': 'Float64', 'ta_nca11': 'String', 'ta_nca12': 'Float64', 'ta_nca13': 'Float64', 'ta_nca14': 'Float64', 'ta_nca15': 'Float64', 'ta_nca16': 'Float64', 'ta_nca17': 'Float64', 'ta_nca2': 'Float64', 'ta_nca3': 'Float64', 'ta_nca4': 'Float64', 'ta_nca5': 'Float64', 'ta_nca6': 'Float64', 'ta_nca7': 'Float64', 'ta_nca8': 'Float64', 'ta_nca9': 'Float64', 'tl': 'Float64', 'tl_cl': 'Float64', 'tl_cl1': 'Float64', 'tl_cl10': 'Float64', 'tl_cl11': 'Float64', 'tl_cl12': 'Float64', 'tl_cl13': 'Float64', 'tl_cl14': 'String', 'tl_cl15': 'Float64', 'tl_cl16': 'Float64', 'tl_cl2': 'Float64', 'tl_cl3': 'Float64', 'tl_cl4': 'Float64', 'tl_cl5': 'Float64', 'tl_cl6': 'Float64', 'tl_cl7': 'String', 'tl_cl8': 'String', 'tl_cl9': 'Float64', 'tl_ncl': 'Float64', 'tl_ncl1': 'Float64', 'tl_ncl10': 'Float64', 'tl_ncl11': 'Float64', 'tl_ncl2': 'Float64', 'tl_ncl3': 'String', 'tl_ncl4': 'String', 'tl_ncl5': 'Float64', 'tl_ncl6': 'Float64', 'tl_ncl7': 'Float64', 'tl_ncl8': 'Float64', 'tl_ncl9': 'Float64', 'tlse': 'Float64', 'tmstamp': 'Int64', 'tse': 'Float64', 'tse_monority': 'Float64', 'tse_pa1': 'Float64', 'tse_pa10': 'Float64', 'tse_pa11': 'Float64', 'tse_pa2': 'Float64', 'tse_pa3': 'String', 'tse_pa4': 'String', 'tse_pa5': 'Float64', 'tse_pa6': 'Float64', 'tse_pa7': 'Float64', 'tse_pa8': 'Float64', 'tse_pa9': 'Float64', 'tse_parent': 'Float64', 'ttm_type': 'Int64', 'updatetime': 'String'}



[2022-08-29 09:48:06,402] [ERROR] AShareBalanceSheet on 2022-08-26 12:00:00 daily_save error: 字段或者类型：{('out_loss_rsrv', 'Float64'), ('unearned_prem_rsrv', 'Float64'), ('insured_pledge_loan', 'Float64'), ('liab_dep_oth_banks_fin_inst', 'Float64'), ('rcv_from_reinsurer', 'Float64'), ('loans_to_oth_banks', 'Float64'), ('clients_cap_deposit', 'Float64'), ('cap_mrgn_paid', 'Float64'), ('deposit_received_ib_deposits', 'Float64'), ('oil_and_natural_gas_assets', 'Float64'), ('spe_cur_liab_diff', 'Float64'), ('spe_bal_assets_diff', 'Float64'), ('oth_assets', 'Float64'), ('cust_bank_dep', 'Float64'), ('life_insur_rsrv', 'Float64'), ('rsrv_insur_cont', 'Float64'), ('dvd_payable_insured', 'Float64'), ('accounts_receivable', 'Float64'), ('rcv_ceded_life_insur_rsrv', 'Float64'), ('borrow_central_bank', 'Float64'), ('lending_funds', 'Float64'), ('payable_to_reinsurer', 'Float64'), ('precious_metals', 'Float64'), ('rcv_ceded_lt_health_insur_rsrv', 'Float64'), ('time_deposits', 'Float64'), ('fin_assets_cost_sharing', 'Float64'), ('prem_rcv', 'Float64'), ('fin_assets_avail_for_sale', 'Float64'), ('asset_dep_oth_banks_fin_inst', 'Float64'), ('acting_uw_sec', 'Float64'), ('claims_payable', 'Float64'), ('payables', 'Float64'), ('lt_health_insur_v', 'Float64'), ('mrgn_paid', 'Float64'), ('rcv_ceded_unearned_prem_rsrv', 'Float64'), ('spe_bal_liab_diff', 'Float64'), ('insured_deposit_invest', 'Float64'), ('oth_liab', 'Float64'), ('cash_deposits_central_bank', 'Float64'), ('prem_received_adv', 'Float64'), ('rcv_from_ceded_insur_cont_rsrv', 'Float64'), ('fin_assets_fair_value', 'Float64'), ('st_financing_payable', 'Float64'), ('held_to_mty_invest', 'Float64'), ('other_equity_tools_p_shr', 'Float64'), ('rcv_ceded_claim_rsrv', 'Float64'), ('prov_nom_risks', 'Float64'), ('incl_seat_fees_exchange', 'Float64'), ('spe_non_cur_assets_diff', 'Float64'), ('spe_bal_shrhldr_eqy_diff', 'Float64'), ('tot_non_cur_liab_diff', 'Float64'), ('clients_rsrv_settle', 'Float64'), ('spe_non_cur_liab_diff', 'Float64'), ('handling_charges_comm_payable', 'Float64'), ('hfs_sales', 'Float64')}与原数据表类型不匹配{'acc_exp': 'String', 'accounts_payable': 'Float64', 'accounts_receivable': 'String', 'accounts_receivable_bill': 'Float64', 'acct_payable': 'Float64', 'acct_rcv': 'Float64', 'acting_trading_sec': 'Float64', 'acting_uw_sec': 'String', 'actual_ann_dt': 'String', 'adv_from_cust': 'Float64', 'agency_bus_assets': 'String', 'agency_bus_liab': 'String', 'ann_dt': 'String', 'asset_dep_oth_banks_fin_inst': 'String', 'bonds_payable': 'Float64', 'borrow_central_bank': 'String', 'cap_mrgn_paid': 'String', 'cap_rsrv': 'Float64', 'cap_stk': 'Float64', 'cash_deposits_central_bank': 'String', 'claims_payable': 'String', 'clients_cap_deposit': 'String', 'clients_rsrv_settle': 'String', 'cnvd_diff_foreign_curr_stat': 'String', 'comp_type_code': 'String', 'const_in_prog': 'Float64', 'const_in_prog_tot': 'Float64', 'consumptive_bio_assets': 'String', 'contract_liabilities': 'Float64', 'contractual_assets': 'Float64', 'crncy_code': 'String', 'cust_bank_dep': 'String', 'debt_investment': 'Float64', 'deferred_exp': 'String', 'deferred_inc': 'String', 'deferred_inc_non_cur_liab': 'Float64', 'deferred_tax_assets': 'Float64', 'deferred_tax_liab': 'Float64', 'deposit_received': 'String', 'deposit_received_ib_deposits': 'String', 'derivative_fin_assets': 'Float64', 'derivative_fin_liab': 'Float64', 'dvd_payable': 'Float64', 'dvd_payable_insured': 'String', 'dvd_rcv': 'Float64', 'empl_ben_payable': 'Float64', 'fin_assets_avail_for_sale': 'String', 'fin_assets_cost_sharing': 'String', 'fin_assets_fair_value': 'String', 'fix_assets': 'Float64', 'fix_assets_disp': 'Float64', 'fund_sales_fin_assets_rp': 'Float64', 'goodwill': 'Float64', 'handling_charges_comm_payable': 'String', 'held_to_mty_invest': 'String', 'hfs_assets': 'Float64', 'hfs_sales': 'String', 'incl_pledge_loan': 'String', 'incl_seat_fees_exchange': 'String', 'independent_acct_assets': 'String', 'independent_acct_liab': 'String', 'insured_deposit_invest': 'String', 'insured_pledge_loan': 'String', 'int_payable': 'Float64', 'int_rcv': 'Float64', 'intang_assets': 'Float64', 'inventories': 'Float64', 'invest_real_estate': 'Float64', 'lending_funds': 'String', 'less_tsy_stk': 'Float64', 'liab_dep_oth_banks_fin_inst': 'String', 'life_insur_rsrv': 'String', 'loans_and_adv_granted': 'Float64', 'loans_oth_banks': 'Float64', 'loans_to_oth_banks': 'String', 'long_term_deferred_exp': 'Float64', 'long_term_eqy_invest': 'Float64', 'long_term_rec': 'Float64', 'lt_borrow': 'Float64', 'lt_health_insur_v': 'String', 'lt_payable': 'Float64', 'lt_payable_tot': 'Float64', 'lt_payroll_payable': 'Float64', 'minority_int': 'Float64', 'monetary_cap': 'Float64', 'mrgn_paid': 'String', 'non_cur_assets_due_within_1y': 'Float64', 'non_cur_liab_due_within_1y': 'Float64', 'notes_payable': 'Float64', 'notes_rcv': 'Float64', 'oil_and_natural_gas_assets': 'String', 'opdate': 'String', 'opmode': 'String', 'oth_assets': 'String', 'oth_cur_assets': 'Float64', 'oth_cur_liab': 'Float64', 'oth_liab': 'String', 'oth_non_cur_assets': 'Float64', 'oth_non_cur_liab': 'Float64', 'oth_payable': 'Float64', 'oth_payable_tot': 'Float64', 'oth_rcv': 'Float64', 'oth_rcv_tot': 'Float64', 'other_comp_income': 'Float64', 'other_debt_investment': 'Float64', 'other_equity_investment': 'Float64', 'other_equity_tools': 'Float64', 'other_equity_tools_p_shr': 'String', 'other_illiquidfinancial_assets': 'Float64', 'other_sustainable_bond': 'Float64', 'out_loss_rsrv': 'String', 'payable_to_reinsurer': 'String', 'payables': 'String', 'precious_metals': 'String', 'prem_rcv': 'String', 'prem_received_adv': 'String', 'prepay': 'Float64', 'productive_bio_assets': 'Float64', 'proj_matl': 'Float64', 'prov_nom_risks': 'String', 'provisions': 'Float64', 'r_and_d_costs': 'Float64', 'rcv_ceded_claim_rsrv': 'String', 'rcv_ceded_life_insur_rsrv': 'String', 'rcv_ceded_lt_health_insur_rsrv': 'String', 'rcv_ceded_unearned_prem_rsrv': 'String', 'rcv_from_ceded_insur_cont_rsrv': 'String', 'rcv_from_reinsurer': 'String', 'rcv_invest': 'String', 'red_monetary_cap_for_sale': 'Float64', 'report_period': 'String', 'rsrv_insur_cont': 'String', 's_info_compcode': 'String', 's_info_windcode': 'String', 'settle_rsrv': 'Float64', 'spe_bal_assets_diff': 'String', 'spe_bal_liab_diff': 'String', 'spe_bal_liab_eqy_diff': 'String', 'spe_bal_shrhldr_eqy_diff': 'String', 'spe_cur_assets_diff': 'Float64', 'spe_cur_liab_diff': 'String', 'spe_non_cur_assets_diff': 'String', 'spe_non_cur_liab_diff': 'String', 'special_rsrv': 'Float64', 'specific_item_payable': 'Float64', 'st_bonds_payable': 'Float64', 'st_borrow': 'Float64', 'st_financing_payable': 'String', 'statement_type': 'String', 'stm_bs_tot': 'Float64', 'subr_rec': 'String', 'surplus_rsrv': 'Float64', 'taxes_surcharges_payable': 'Float64', 'time_deposits': 'String', 'tot_assets': 'Float64', 'tot_bal_assets_diff': 'Float64', 'tot_bal_liab_diff': 'Float64', 'tot_bal_liab_eqy_diff': 'Float64', 'tot_bal_shrhldr_eqy_diff': 'Float64', 'tot_cur_assets': 'Float64', 'tot_cur_assets_diff': 'Float64', 'tot_cur_liab': 'Float64', 'tot_cur_liab_diff': 'Float64', 'tot_liab': 'Float64', 'tot_liab_shrhldr_eqy': 'Float64', 'tot_non_cur_assets': 'Float64', 'tot_non_cur_assets_diff': 'Float64', 'tot_non_cur_liab': 'Float64', 'tot_non_cur_liab_diff': 'String', 'tot_shr': 'Float64', 'tot_shrhldr_eqy_excl_min_int': 'Float64', 'tot_shrhldr_eqy_incl_min_int': 'Float64', 'tradable_fin_assets': 'Float64', 'tradable_fin_liab': 'Float64', 'unconfirmed_invest_loss': 'String', 'undistributed_profit': 'Float64', 'unearned_prem_rsrv': 'String', 'wind_code': 'String'}

[2022-08-29 10:17:42,340] [ERROR] Rpt_Forecast_Stk on 2022-08-26 00:00:00 daily_save error: 字段或者类型：{('language', 'Int64'), ('is_capital_change', 'Int64'), ('reliability', 'String')}与原数据表类型不匹配{'attention': 'String', 'author_name': 'String', 'create_date': 'DateTime64', 'currency': 'String', 'current_price': 'Float64', 'entrytime': 'String', 'forecast_dps': 'Float64', 'forecast_eps': 'Float64', 'forecast_ev_ebitda': 'Float64', 'forecast_np': 'Float64', 'forecast_op': 'Float64', 'forecast_or': 'Float64', 'forecast_pe': 'Float64', 'forecast_rd': 'Float64', 'forecast_roe': 'Float64', 'forecast_tp': 'Float64', 'gg_rating_code': 'String', 'gg_rating_content': 'String', 'is_capital_change': 'Float64', 'language': 'Float64', 'organ_id': 'Int64', 'organ_name': 'String', 'organ_rating_code': 'String', 'organ_rating_content': 'String', 'refered_capital': 'Float64', 'reliability': 'Float64', 'report_id': 'Int64', 'report_quarter': 'Float64', 'report_type': 'Int64', 'report_year': 'Float64', 'rptime': 'DateTime64', 'settlement_date': 'String', 'stock_code': 'String', 'stock_name': 'String', 'target_price_ceiling': 'Float64', 'target_price_floor': 'Float64', 'title': 'String', 'tmstamp': 'Int64', 'updatetime': 'String'}



[2022-08-29 11:17:03,167] [ERROR] AShareBalanceSheet on 2022-08-26 12:00:00 daily_save error: 字段或者类型：{('cash_deposits_central_bank', 'Float64'), ('prem_received_adv', 'Float64'), ('prov_nom_risks', 'Float64'), ('insured_deposit_invest', 'Float64'), ('cust_bank_dep', 'Float64'), ('fin_assets_cost_sharing', 'Float64'), ('rcv_from_reinsurer', 'Float64'), ('liab_dep_oth_banks_fin_inst', 'Float64'), ('acting_uw_sec', 'Float64'), ('held_to_mty_invest', 'Float64'), ('prem_rcv', 'Float64'), ('spe_non_cur_assets_diff', 'Float64'), ('cap_mrgn_paid', 'Float64'), ('time_deposits', 'Float64'), ('tot_non_cur_liab_diff', 'Float64'), ('spe_bal_liab_diff', 'Float64'), ('rcv_ceded_life_insur_rsrv', 'Float64'), ('handling_charges_comm_payable', 'Float64'), ('accounts_receivable', 'Float64'), ('out_loss_rsrv', 'Float64'), ('insured_pledge_loan', 'Float64'), ('mrgn_paid', 'Float64'), ('oth_liab', 'Float64'), ('lending_funds', 'Float64'), ('incl_seat_fees_exchange', 'Float64'), ('oil_and_natural_gas_assets', 'Float64'), ('life_insur_rsrv', 'Float64'), ('spe_non_cur_liab_diff', 'Float64'), ('borrow_central_bank', 'Float64'), ('spe_bal_shrhldr_eqy_diff', 'Float64'), ('payable_to_reinsurer', 'Float64'), ('dvd_payable_insured', 'Float64'), ('loans_to_oth_banks', 'Float64'), ('st_financing_payable', 'Float64'), ('rcv_ceded_lt_health_insur_rsrv', 'Float64'), ('rcv_from_ceded_insur_cont_rsrv', 'Float64'), ('fin_assets_avail_for_sale', 'Float64'), ('spe_bal_assets_diff', 'Float64'), ('rsrv_insur_cont', 'Float64'), ('hfs_sales', 'Float64'), ('deposit_received_ib_deposits', 'Float64'), ('precious_metals', 'Float64'), ('unearned_prem_rsrv', 'Float64'), ('oth_assets', 'Float64'), ('asset_dep_oth_banks_fin_inst', 'Float64'), ('rcv_ceded_unearned_prem_rsrv', 'Float64'), ('claims_payable', 'Float64'), ('other_equity_tools_p_shr', 'Float64'), ('spe_cur_liab_diff', 'Float64'), ('clients_rsrv_settle', 'Float64'), ('payables', 'Float64'), ('rcv_ceded_claim_rsrv', 'Float64'), ('lt_health_insur_v', 'Float64'), ('fin_assets_fair_value', 'Float64'), ('clients_cap_deposit', 'Float64')}与原数据表类型不匹配{'acc_exp': 'String', 'accounts_payable': 'Float64', 'accounts_receivable': 'String', 'accounts_receivable_bill': 'Float64', 'acct_payable': 'Float64', 'acct_rcv': 'Float64', 'acting_trading_sec': 'Float64', 'acting_uw_sec': 'String', 'actual_ann_dt': 'String', 'adv_from_cust': 'Float64', 'agency_bus_assets': 'String', 'agency_bus_liab': 'String', 'ann_dt': 'String', 'asset_dep_oth_banks_fin_inst': 'String', 'bonds_payable': 'Float64', 'borrow_central_bank': 'String', 'cap_mrgn_paid': 'String', 'cap_rsrv': 'Float64', 'cap_stk': 'Float64', 'cash_deposits_central_bank': 'String', 'claims_payable': 'String', 'clients_cap_deposit': 'String', 'clients_rsrv_settle': 'String', 'cnvd_diff_foreign_curr_stat': 'String', 'comp_type_code': 'String', 'const_in_prog': 'Float64', 'const_in_prog_tot': 'Float64', 'consumptive_bio_assets': 'String', 'contract_liabilities': 'Float64', 'contractual_assets': 'Float64', 'crncy_code': 'String', 'cust_bank_dep': 'String', 'debt_investment': 'Float64', 'deferred_exp': 'String', 'deferred_inc': 'String', 'deferred_inc_non_cur_liab': 'Float64', 'deferred_tax_assets': 'Float64', 'deferred_tax_liab': 'Float64', 'deposit_received': 'String', 'deposit_received_ib_deposits': 'String', 'derivative_fin_assets': 'Float64', 'derivative_fin_liab': 'Float64', 'dvd_payable': 'Float64', 'dvd_payable_insured': 'String', 'dvd_rcv': 'Float64', 'empl_ben_payable': 'Float64', 'fin_assets_avail_for_sale': 'String', 'fin_assets_cost_sharing': 'String', 'fin_assets_fair_value': 'String', 'fix_assets': 'Float64', 'fix_assets_disp': 'Float64', 'fund_sales_fin_assets_rp': 'Float64', 'goodwill': 'Float64', 'handling_charges_comm_payable': 'String', 'held_to_mty_invest': 'String', 'hfs_assets': 'Float64', 'hfs_sales': 'String', 'incl_pledge_loan': 'String', 'incl_seat_fees_exchange': 'String', 'independent_acct_assets': 'String', 'independent_acct_liab': 'String', 'insured_deposit_invest': 'String', 'insured_pledge_loan': 'String', 'int_payable': 'Float64', 'int_rcv': 'Float64', 'intang_assets': 'Float64', 'inventories': 'Float64', 'invest_real_estate': 'Float64', 'lending_funds': 'String', 'less_tsy_stk': 'Float64', 'liab_dep_oth_banks_fin_inst': 'String', 'life_insur_rsrv': 'String', 'loans_and_adv_granted': 'Float64', 'loans_oth_banks': 'Float64', 'loans_to_oth_banks': 'String', 'long_term_deferred_exp': 'Float64', 'long_term_eqy_invest': 'Float64', 'long_term_rec': 'Float64', 'lt_borrow': 'Float64', 'lt_health_insur_v': 'String', 'lt_payable': 'Float64', 'lt_payable_tot': 'Float64', 'lt_payroll_payable': 'Float64', 'minority_int': 'Float64', 'monetary_cap': 'Float64', 'mrgn_paid': 'String', 'non_cur_assets_due_within_1y': 'Float64', 'non_cur_liab_due_within_1y': 'Float64', 'notes_payable': 'Float64', 'notes_rcv': 'Float64', 'oil_and_natural_gas_assets': 'String', 'opdate': 'String', 'opmode': 'String', 'oth_assets': 'String', 'oth_cur_assets': 'Float64', 'oth_cur_liab': 'Float64', 'oth_liab': 'String', 'oth_non_cur_assets': 'Float64', 'oth_non_cur_liab': 'Float64', 'oth_payable': 'Float64', 'oth_payable_tot': 'Float64', 'oth_rcv': 'Float64', 'oth_rcv_tot': 'Float64', 'other_comp_income': 'Float64', 'other_debt_investment': 'Float64', 'other_equity_investment': 'Float64', 'other_equity_tools': 'Float64', 'other_equity_tools_p_shr': 'String', 'other_illiquidfinancial_assets': 'Float64', 'other_sustainable_bond': 'Float64', 'out_loss_rsrv': 'String', 'payable_to_reinsurer': 'String', 'payables': 'String', 'precious_metals': 'String', 'prem_rcv': 'String', 'prem_received_adv': 'String', 'prepay': 'Float64', 'productive_bio_assets': 'Float64', 'proj_matl': 'Float64', 'prov_nom_risks': 'String', 'provisions': 'Float64', 'r_and_d_costs': 'Float64', 'rcv_ceded_claim_rsrv': 'String', 'rcv_ceded_life_insur_rsrv': 'String', 'rcv_ceded_lt_health_insur_rsrv': 'String', 'rcv_ceded_unearned_prem_rsrv': 'String', 'rcv_from_ceded_insur_cont_rsrv': 'String', 'rcv_from_reinsurer': 'String', 'rcv_invest': 'String', 'red_monetary_cap_for_sale': 'Float64', 'report_period': 'String', 'rsrv_insur_cont': 'String', 's_info_compcode': 'String', 's_info_windcode': 'String', 'settle_rsrv': 'Float64', 'spe_bal_assets_diff': 'String', 'spe_bal_liab_diff': 'String', 'spe_bal_liab_eqy_diff': 'String', 'spe_bal_shrhldr_eqy_diff': 'String', 'spe_cur_assets_diff': 'Float64', 'spe_cur_liab_diff': 'String', 'spe_non_cur_assets_diff': 'String', 'spe_non_cur_liab_diff': 'String', 'special_rsrv': 'Float64', 'specific_item_payable': 'Float64', 'st_bonds_payable': 'Float64', 'st_borrow': 'Float64', 'st_financing_payable': 'String', 'statement_type': 'String', 'stm_bs_tot': 'Float64', 'subr_rec': 'String', 'surplus_rsrv': 'Float64', 'taxes_surcharges_payable': 'Float64', 'time_deposits': 'String', 'tot_assets': 'Float64', 'tot_bal_assets_diff': 'Float64', 'tot_bal_liab_diff': 'Float64', 'tot_bal_liab_eqy_diff': 'Float64', 'tot_bal_shrhldr_eqy_diff': 'Float64', 'tot_cur_assets': 'Float64', 'tot_cur_assets_diff': 'Float64', 'tot_cur_liab': 'Float64', 'tot_cur_liab_diff': 'Float64', 'tot_liab': 'Float64', 'tot_liab_shrhldr_eqy': 'Float64', 'tot_non_cur_assets': 'Float64', 'tot_non_cur_assets_diff': 'Float64', 'tot_non_cur_liab': 'Float64', 'tot_non_cur_liab_diff': 'String', 'tot_shr': 'Float64', 'tot_shrhldr_eqy_excl_min_int': 'Float64', 'tot_shrhldr_eqy_incl_min_int': 'Float64', 'tradable_fin_assets': 'Float64', 'tradable_fin_liab': 'Float64', 'unconfirmed_invest_loss': 'String', 'undistributed_profit': 'Float64', 'unearned_prem_rsrv': 'String', 'wind_code': 'String'}

[2022-08-29 13:40:54,644] [ERROR] AShareTTMHis on 2022-08-28 12:00:00 daily_save error: 字段或者类型：{('s_fa_expense_ttm', 'String')}与原数据表类型不匹配{'ann_dt': 'String', 'continuous_net_op_ttm': 'Float64', 'crncy_code': 'String', 'fa_roic_ttm': 'Float64', 'fa_roic_ttm2': 'Float64', 'inc_tax_ttm': 'Float64', 'int_exp_ttm': 'Float64', 'minority_int_ttm': 'Float64', 'net_cash_flows_oper_act_ttm': 'Float64', 'net_incr_cash_cash_equ_ttm': 'Float64', 'net_profit_parent_comp_ttm': 'Float64', 'net_profit_ttm': 'Float64', 'netoptotaxprofit': 'Float64', 'noncontinuous_net_op_ttm': 'Float64', 'nonnetoptotaxprofit': 'Float64', 'opdate': 'String', 'oper_rev_ttm': 'Float64', 'opmode': 'String', 'report_period': 'String', 'roa_exclminintinc_ttm': 'Float64', 's_fa_adminexpense_ttm': 'Float64', 's_fa_adminexpensetogr_ttm': 'Float64', 's_fa_asset_mrq': 'Float64', 's_fa_cost_ttm': 'Float64', 's_fa_debt_mrq': 'Float64', 's_fa_debttoassets_mrq': 'Float64', 's_fa_deductedprofit_ttm': 'Float64', 's_fa_ebit_ttm': 'Float64', 's_fa_ebit_ttm_inverse': 'Float64', 's_fa_ebitda_ttm': 'Float64', 's_fa_ebitda_ttm_inverse': 'Float64', 's_fa_ebt_ttm': 'Float64', 's_fa_ebttoor_ttm': 'Float64', 's_fa_equity_mrq': 'Float64', 's_fa_expense': 'Float64', 's_fa_expense_ttm': 'Float64', 's_fa_expensetosales_ttm': 'Float64', 's_fa_finaexpense_ttm': 'Float64', 's_fa_finaexpensetogr_ttm': 'Float64', 's_fa_financecashflow_ttm': 'Float64', 's_fa_gc_ttm': 'Float64', 's_fa_gctogr_ttm': 'Float64', 's_fa_gr_ttm': 'Float64', 's_fa_grossmargin_ttm': 'Float64', 's_fa_grossprofitmargin_ttm': 'Float64', 's_fa_impairment_ttm': 'Float64', 's_fa_impairtogr_ttm': 'Float64', 's_fa_investcapital_mrq': 'Float64', 's_fa_investcashflow_ttm': 'Float64', 's_fa_investincome_ttm': 'Float64', 's_fa_investincometoebt_ttm': 'Float64', 's_fa_netprofitmargin_ttm': 'Float64', 's_fa_netprofittoor_ttm': 'Float64', 's_fa_nonoperateprofit_ttm': 'Float64', 's_fa_nonoperateprofittoebt_ttm': 'Float64', 's_fa_nonopprofit_ttm': 'Float64', 's_fa_noptoebt_ttm': 'Float64', 's_fa_ocftoop_ttm': 'Float64', 's_fa_ocftooperateincome_ttm': 'Float64', 's_fa_ocftoor_ttm': 'Float64', 's_fa_op_ttm': 'Float64', 's_fa_operateexpense_ttm': 'Float64', 's_fa_operateexpensetogr_ttm': 'Float64', 's_fa_operateincome_ttm': 'Float64', 's_fa_operateincometoebt_ttm': 'Float64', 's_fa_optoebt_ttm': 'Float64', 's_fa_optogr_ttm': 'Float64', 's_fa_optoor_ttm': 'Float64', 's_fa_prefinexp_op_ttm': 'Float64', 's_fa_prefinexpoptoebt_ttm': 'Float64', 's_fa_prefinexpoptoor_ttm': 'Float64', 's_fa_profittogr_ttm': 'Float64', 's_fa_roa2_ttm': 'Float64', 's_fa_roa_ttm': 'Float64', 's_fa_roe_ttm': 'Float64', 's_fa_salescashin_ttm': 'Float64', 's_fa_salescashintoor_ttm': 'Float64', 's_fa_taxtoebt_ttm': 'Float64', 's_fa_totalequity_mrq': 'Float64', 's_info_compcode': 'String', 's_info_windcode': 'String', 's_stm_bsmrq': 'Float64', 'statement_type': 'String', 'tot_oper_rev_ttm': 'Float64'}

有两个报错的： 直接注释掉了

```python
'CiticIndustry', 'ShenwanIndustry',
[2022-08-29 09:48:58,419] [ERROR] ShenwanIndustry on 2022-08-25 daily_save error: Unable to cast Python instance to C++ type (compile in debug mode for details)

```

有一个报错的也直接注释掉了：

```python
'Con_Forecast_Stk',Fin_Performance_Forecast Fin_Performance_Express
[2022-08-29 09:49:15,556] [ERROR] Con_Forecast_Stk on 2022-08-26 00:00:00 daily_save error: 字段con_eps_hisdate 数据格式为<class 'pandas._libs.tslibs.nattype.NaTType'>，protobuf序列化无法解析,expect: int, float, bool, str,datetime

```

8.31

总共71个类型的

```python
偶尔会爆一下两个错
ERROR:root:AShareBalanceSheet on 2019-04-10 12:00:00 daily_save error: Unable to cast Python instance to C++ type (compile in debug mode for details)

ERROR:root:AShareEODDerivativeIndicator on 2019-04-09 12:00:00 daily_save error: cannot convert float NaN to integer

```

